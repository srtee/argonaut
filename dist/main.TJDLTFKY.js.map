{
  "version": 3,
  "sources": ["../lib/state.js", "../lib/dom.js", "../lib/ui/theme.js", "../lib/ui/notifications.js", "../lib/papers.js", "../lib/ui/storage.js", "../lib/ui/export.js", "../lib/ui/load.js", "../lib/ui/inputOptions.js", "../lib/ui/saveOptions.js", "../lib/ui/tagEditor.js", "../lib/ui/comments.js", "../lib/ui/onboarding.js", "../lib/ui/index.js", "../lib/github.js", "../lib/auth.js", "../lib/main.js"],
  "sourcesContent": ["// Global state management with immutability and auto-persistence\n\nconst STORAGE_KEY = 'appState';\nconst WORKER_BASE_URL = 'https://argonaut-github-proxy.shernren.workers.dev';\n\n// Initial state definition\nconst initialState = {\n    papersData: {},\n    selectedTags: new Set(),\n    processedPapersData: [],\n    currentEditingKey: null,\n    tentativeTags: [],\n    tentativeTagsRemoved: []\n};\n\n// Change notification listeners\nconst listeners = new Set();\n\n// Persist state to sessionStorage\nconst persist = (state) => {\n    try {\n        const toSave = {\n            ...state,\n            selectedTags: Array.from(state.selectedTags) // Set \u2192 Array for JSON\n        };\n        sessionStorage.setItem(STORAGE_KEY, JSON.stringify(toSave));\n    } catch (e) {\n        console.warn('Failed to persist state:', e);\n    }\n};\n\n// Restore state from sessionStorage\nconst loadFromStorage = () => {\n    try {\n        const saved = sessionStorage.getItem(STORAGE_KEY);\n        return saved ? JSON.parse(saved) : {};\n    } catch (e) {\n        console.warn('Failed to load state from storage:', e);\n        return {};\n    }\n};\n\n// Initialize state from storage\nlet _state = {\n    ...initialState,\n    ...loadFromStorage(),\n    selectedTags: new Set(loadFromStorage().selectedTags || [])\n};\n\n// Store API\nexport const store = {\n    /**\n     * Get a copy of the current state (immutable)\n     * @returns {Object} Copy of current state\n     */\n    get: () => ({ ..._state }),\n\n    /**\n     * Update state with partial updates (immutable)\n     * @param {Object} updates - Key-value pairs to update\n     */\n    set: (updates) => {\n        _state = { ..._state, ...updates };\n        persist(_state);\n        listeners.forEach(fn => fn(_state));\n    },\n\n    /**\n     * Set selected tags (special handler for Set)\n     * @param {string[]|Set} tags - Array or Set of tags\n     */\n    setSelectedTags: (tags) => {\n        _state = { ..._state, selectedTags: new Set(tags) };\n        persist(_state);\n        listeners.forEach(fn => fn(_state));\n    },\n\n    /**\n     * Subscribe to state changes\n     * @param {Function} fn - Callback function receiving new state\n     * @returns {Function} Unsubscribe function\n     */\n    subscribe: (fn) => {\n        listeners.add(fn);\n        // Immediately call with current state\n        fn(_state);\n        return () => listeners.delete(fn);\n    }\n};\n\n// Backward compatibility: export `state` as a proxy\n// Reads work, writes warn and redirect to store.set()\nexport const state = new Proxy({}, {\n    get(_, prop) {\n        return _state[prop];\n    },\n    set(_, prop, value) {\n        console.warn(`Direct mutation of state.${prop} is discouraged. Use store.set() instead.`);\n        _state[prop] = value;\n        return true;\n    }\n});\n\n// Export the worker base URL constant\nexport { WORKER_BASE_URL };", "/**\n * DOM Registry - Centralized DOM element management\n *\n * Provides a single source of truth for all DOM element references.\n * Modules register their elements, and the registry validates and provides access.\n */\n\n// Registry storage\nconst registry = new Map();\n\n// Module registrations\nconst moduleElements = new Map();\n\n/**\n * Register elements for a specific module\n * @param {string} moduleName - Name of the module (e.g., 'ui', 'auth', 'papers', 'github')\n * @param {Object} elements - Object mapping element IDs to their DOM references\n */\nexport function register(moduleName, elements) {\n    moduleElements.set(moduleName, elements);\n    console.log(`[DOM Registry] Registered ${Object.keys(elements).length} elements for module: ${moduleName}`);\n}\n\n/**\n * Get an element by ID\n * @param {string} id - Element ID\n * @returns {HTMLElement|null} - The element or null if not found\n */\nexport function get(id) {\n    return registry.get(id) || null;\n}\n\n/**\n * Get an element by ID, throwing if not found\n * @param {string} id - Element ID\n * @returns {HTMLElement} - The element\n * @throws {Error} - If element is not found\n */\nexport function getRequired(id) {\n    const element = registry.get(id);\n    if (!element) {\n        throw new Error(`[DOM Registry] Required element not found: #${id}`);\n    }\n    return element;\n}\n\n/**\n * Get multiple elements at once\n * @param {...string} ids - Element IDs to retrieve\n * @returns {Object} - Object mapping IDs to elements (null for missing)\n */\nexport function getMultiple(...ids) {\n    const result = {};\n    for (const id of ids) {\n        result[id] = registry.get(id) || null;\n    }\n    return result;\n}\n\n/**\n * Check if an element exists in the registry\n * @param {string} id - Element ID\n * @returns {boolean} - True if element exists\n */\nexport function has(id) {\n    return registry.has(id);\n}\n\n/**\n * Initialize all registered elements\n * Calls all module registration functions and validates elements\n */\nexport function initAll() {\n    console.log('[DOM Registry] Initializing all DOM elements...');\n\n    // Register all module elements\n    registerUI();\n    registerAuth();\n    registerPapers();\n    registerGitHub();\n\n    // Validate all required elements\n    validateRegistry();\n\n    console.log('[DOM Registry] Initialization complete');\n}\n\n/**\n * Register UI module elements\n */\nfunction registerUI() {\n    register('ui', {\n        // Main sections\n        loadJsonSection: document.getElementById('loadJsonSection'),\n        saveJsonSection: document.getElementById('saveJsonSection'),\n        papersSection: document.getElementById('papersSection'),\n        exportResetSection: document.getElementById('exportResetSection'),\n        papersList: document.getElementById('papersList'),\n\n        // Load inputs\n        fileInput: document.getElementById('fileInput'),\n        urlInput: document.getElementById('urlInput'),\n        loadUrlBtn: document.getElementById('loadUrlBtn'),\n        loadFromStorageBtn: document.getElementById('loadFromStorageBtn'),\n        loadNewBtn: document.getElementById('loadNewBtn'),\n\n        // Save/Export\n        saveToStorageBtn: document.getElementById('saveToStorageBtn'),\n        exportJsonBtn: document.getElementById('exportJsonBtn'),\n        exportBibtexAllBtn: document.getElementById('exportBibtexAllBtn'),\n        exportBibtexTaggedBtn: document.getElementById('exportBibtexTaggedBtn'),\n\n        // Format selector\n        jsonFormatSelector: document.getElementById('jsonFormatSelector'),\n\n        // Notifications\n        error: document.getElementById('error'),\n        status: document.getElementById('status'),\n\n        // Theme\n        themeToggle: document.getElementById('themeToggle'),\n\n        // Onboarding\n        onboardingModal: document.getElementById('onboardingModal'),\n        closeOnboardingBtn: document.getElementById('closeOnboardingBtn'),\n        showOnboardingBtn: document.getElementById('showOnboardingBtn'),\n        onboardingNextBtn: document.getElementById('onboardingNextBtn'),\n        onboardingBackBtn: document.getElementById('onboardingBackBtn'),\n        onboardingCompleteBtn: document.getElementById('onboardingCompleteBtn'),\n    });\n}\n\n/**\n * Register Auth module elements\n */\nfunction registerAuth() {\n    register('auth', {\n        // GitHub auth\n        githubSection: document.getElementById('githubSection'),\n        githubNotLoggedIn: document.getElementById('githubNotLoggedIn'),\n        githubLoggedIn: document.getElementById('githubLoggedIn'),\n        githubConnectBtn: document.getElementById('githubConnectBtn'),\n        githubLogoutBtn: document.getElementById('githubLogoutBtn'),\n        githubUserAvatar: document.getElementById('githubUserAvatar'),\n        githubUserName: document.getElementById('githubUserName'),\n\n        // Visibility toggles (shared with other modules)\n        gistConnectedContent: document.getElementById('gistConnectedContent'),\n        saveGistConnectedContent: document.getElementById('saveGistConnectedContent'),\n    });\n}\n\n/**\n * Register Papers module elements\n */\nfunction registerPapers() {\n    register('papers', {\n        // Main sections (shared with ui)\n        papersList: document.getElementById('papersList'),\n        loadJsonSection: document.getElementById('loadJsonSection'),\n        saveJsonSection: document.getElementById('saveJsonSection'),\n        exportResetSection: document.getElementById('exportResetSection'),\n        papersSection: document.getElementById('papersSection'),\n\n        // DOI input\n        doiInput: document.getElementById('doiInput'),\n        doiKeyInput: document.getElementById('doiKeyInput'),\n        addDoiBtn: document.getElementById('addDoiBtn'),\n\n        // Status (shared with ui)\n        status: document.getElementById('status'),\n\n        // Export buttons\n        exportBibtexTaggedBtn: document.getElementById('exportBibtexTaggedBtn'),\n    });\n}\n\n/**\n * Register GitHub module elements\n */\nfunction registerGitHub() {\n    register('github', {\n        // Gist selectors\n        loadGistSelector: document.getElementById('loadGistSelector'),\n        saveGistSelector: document.getElementById('saveGistSelector'),\n        loadFromGistCollectionBtn: document.getElementById('loadFromGistCollectionBtn'),\n        saveToGistOptionBtn: document.getElementById('saveToGistOptionBtn'),\n\n        // Visibility toggles\n        gistConnectedContent: document.getElementById('gistConnectedContent'),\n        saveGistConnectedContent: document.getElementById('saveGistConnectedContent'),\n\n        // Format selector (shared with ui)\n        jsonFormatSelector: document.getElementById('jsonFormatSelector'),\n    });\n}\n\n/**\n * Validate that all registered elements exist in the DOM\n * Logs warnings for missing elements\n */\nfunction validateRegistry() {\n    let missingCount = 0;\n\n    for (const [moduleName, elements] of moduleElements) {\n        for (const [name, element] of Object.entries(elements)) {\n            if (!element) {\n                console.warn(`[DOM Registry] Missing element: #${name} (module: ${moduleName})`);\n                missingCount++;\n            } else {\n                // Add to registry\n                registry.set(name, element);\n            }\n        }\n    }\n\n    if (missingCount > 0) {\n        console.warn(`[DOM Registry] ${missingCount} element(s) missing from DOM`);\n    }\n\n    console.log(`[DOM Registry] ${registry.size} elements registered`);\n}\n\n/**\n * Get all registered element IDs\n * @returns {string[]} - Array of registered element IDs\n */\nexport function getRegisteredIds() {\n    return Array.from(registry.keys());\n}\n\n/**\n * Get registry statistics\n * @returns {Object} - Statistics about registered elements\n */\nexport function getStats() {\n    const stats = {\n        total: registry.size,\n        byModule: {}\n    };\n\n    for (const [moduleName, elements] of moduleElements) {\n        const found = Object.values(elements).filter(e => e !== null).length;\n        const total = Object.keys(elements).length;\n        stats.byModule[moduleName] = { found, total };\n    }\n\n    return stats;\n}\n", "// Theme module - theme management\n\nimport { get } from '../dom.js';\n\nlet themeToggle;\nlet sunIcon;\nlet moonIcon;\nconst THEME_KEY = 'theme';\n\nexport function initThemeDOM() {\n    themeToggle = get('themeToggle');\n    sunIcon = document.querySelector('.theme-toggle__icon--sun');\n    moonIcon = document.querySelector('.theme-toggle__icon--moon');\n}\n\n/**\n * Update theme icons based on dark mode\n */\nexport function updateThemeIcons(isDark) {\n    if (sunIcon) sunIcon.style.display = isDark ? 'block' : 'none';\n    if (moonIcon) moonIcon.style.display = isDark ? 'none' : 'block';\n}\n\n/**\n * Get system color scheme preference\n */\nexport function getSystemPreference() {\n    return window.matchMedia('(prefers-color-scheme: dark)').matches;\n}\n\n/**\n * Get stored theme from localStorage\n */\nexport function getStoredTheme() {\n    const stored = localStorage.getItem(THEME_KEY);\n    if (stored === 'dark') return 'dark';\n    if (stored === 'light') return 'light';\n    return null;\n}\n\n/**\n * Set the theme\n */\nexport function setTheme(theme) {\n    const isDark = theme === 'dark';\n    if (isDark) {\n        document.documentElement.setAttribute('data-theme', 'dark');\n    } else {\n        document.documentElement.removeAttribute('data-theme');\n    }\n    localStorage.setItem(THEME_KEY, theme);\n    updateThemeIcons(isDark);\n}\n\n/**\n * Initialize theme on page load\n */\nexport function initTheme() {\n    const storedTheme = getStoredTheme();\n    if (storedTheme) {\n        setTheme(storedTheme);\n    } else {\n        const isDark = getSystemPreference();\n        // Set initial theme without saving to localStorage\n        if (isDark) {\n            document.documentElement.setAttribute('data-theme', 'dark');\n        } else {\n            document.documentElement.removeAttribute('data-theme');\n        }\n        updateThemeIcons(isDark);\n    }\n}\n\n/**\n * Initialize theme event listener\n */\nexport function initThemeListener() {\n    if (themeToggle) {\n        themeToggle.addEventListener('click', () => {\n            const currentTheme = document.documentElement.getAttribute('data-theme');\n            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';\n            setTheme(newTheme);\n        });\n    }\n\n    // System color scheme changes\n    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {\n        if (!localStorage.getItem(THEME_KEY)) {\n            setTheme(e.matches ? 'dark' : 'light');\n        }\n    });\n}\n", "// Notifications module - status/error messages\n\nimport { get } from '../dom.js';\n\nlet error;\nlet status;\n\nexport function initNotificationsDOM() {\n    error = get('error');\n    status = get('status');\n}\n\n/**\n * Escape HTML to prevent XSS\n */\nexport function escapeHtml(text) {\n    if (!text) return '';\n    const div = document.createElement('div');\n    div.textContent = text;\n    return div.innerHTML;\n}\n\n/**\n * Show error message\n */\nexport function showError(message) {\n    error.textContent = message;\n    error.classList.add('error--visible');\n    setTimeout(() => {\n        error.classList.remove('error--visible');\n    }, 5000);\n}\n\n/**\n * Show status message\n */\nexport function showStatus(message) {\n    status.textContent = message;\n    status.classList.add('status--visible');\n}\n\n/**\n * Hide status message\n */\nexport function hideStatus() {\n    status.classList.remove('status--visible');\n}\n\n/**\n * Hide error message\n */\nexport function hideError() {\n    error.classList.remove('error--visible');\n}\n", "// DOI, BibTeX, processing, and rendering functions\n\nimport { state, store } from './state.js';\nimport { get, getMultiple } from './dom.js';\n\n// DOM Elements - via registry\nlet papersList;\nlet loadJsonSection;\nlet saveJsonSection;\nlet exportResetSection;\nlet papersSection;\nlet doiInput;\nlet doiKeyInput;\nlet addDoiBtn;\nlet status;\nlet exportBibtexTaggedBtn;\n\n// Initialize all DOM elements - must be called after DOM is ready\nexport function initDOM() {\n    const elements = getMultiple(\n        'papersList',\n        'loadJsonSection',\n        'saveJsonSection',\n        'exportResetSection',\n        'papersSection',\n        'doiInput',\n        'doiKeyInput',\n        'addDoiBtn',\n        'status',\n        'exportBibtexTaggedBtn'\n    );\n\n    papersList = elements.papersList;\n    loadJsonSection = elements.loadJsonSection;\n    saveJsonSection = elements.saveJsonSection;\n    exportResetSection = elements.exportResetSection;\n    papersSection = elements.papersSection;\n    doiInput = elements.doiInput;\n    doiKeyInput = elements.doiKeyInput;\n    addDoiBtn = elements.addDoiBtn;\n    status = elements.status;\n    exportBibtexTaggedBtn = elements.exportBibtexTaggedBtn;\n\n    console.log('[Papers] DOM elements initialized');\n}\n\n/**\n * Extract DOI from input string\n */\nexport function extractDOI(input) {\n    const doiRegex = /(10\\.\\d{4,9}\\/[-._;()/:A-Z0-9]+)/i;\n    const match = input.match(doiRegex);\n    return match ? match[1] : null;\n}\n\n/**\n * Fetch BibTeX for a DOI\n */\nexport async function fetchBibTeX(doi) {\n    try {\n        const response = await fetch(`https://doi.org/${encodeURIComponent(doi)}`, {\n            headers: {\n                'Accept': 'application/x-bibtex'\n            }\n        });\n\n        if (!response.ok) {\n            throw new Error(`Failed to fetch BibTeX: ${response.status}`);\n        }\n\n        return await response.text();\n    } catch (err) {\n        console.error('Error fetching BibTeX:', err);\n        return null;\n    }\n}\n\n/**\n * Fetch abstract from Semantic Scholar API\n */\nexport async function fetchAbstractFromSemanticScholar(doi) {\n    try {\n        const response = await fetch(\n            `https://api.semanticscholar.org/graph/v1/paper/DOI:${encodeURIComponent(doi)}?fields=abstract`,\n            {\n                headers: {\n                    'Accept': 'application/json'\n                }\n            }\n        );\n\n        if (!response.ok) {\n            return null;\n        }\n\n        const data = await response.json();\n        if (data.abstract) {\n            return data.abstract;\n        }\n\n        return null;\n    } catch (err) {\n        console.error('Error fetching abstract from Semantic Scholar:', err);\n        return null;\n    }\n}\n\n/**\n * Fetch abstract from Crossref API\n */\nexport async function fetchAbstractFromCrossref(doi) {\n    try {\n        const response = await fetch(\n            `https://api.crossref.org/works/${encodeURIComponent(doi)}`,\n            {\n                headers: {\n                    'Accept': 'application/json'\n                }\n            }\n        );\n\n        if (!response.ok) {\n            return null;\n        }\n\n        const data = await response.json();\n        if (data.message && data.message.abstract) {\n            return data.message.abstract;\n        }\n\n        return null;\n    } catch (err) {\n        console.error('Error fetching abstract from Crossref:', err);\n        return null;\n    }\n}\n\n/**\n * Fetch abstract - tries Semantic Scholar first, then Crossref\n */\nexport async function fetchAbstract(doi) {\n    // Try Semantic Scholar first\n    let abstract = await fetchAbstractFromSemanticScholar(doi);\n    if (abstract) {\n        return abstract;\n    }\n\n    // Fallback to Crossref\n    abstract = await fetchAbstractFromCrossref(doi);\n    return abstract;\n}\n\n/**\n * Fetch page numbers from Crossref API\n */\nexport async function fetchPagesFromCrossref(doi) {\n    try {\n        const response = await fetch(\n            `https://api.crossref.org/works/${encodeURIComponent(doi)}`,\n            {\n                headers: {\n                    'Accept': 'application/json'\n                }\n            }\n        );\n\n        if (!response.ok) {\n            return null;\n        }\n\n        const data = await response.json();\n        if (data.message) {\n            // Check for page field first\n            if (data.message.page) {\n                return data.message.page;\n            }\n            // Some journals use article-number instead of pages\n            if (data.message['article-number']) {\n                return data.message['article-number'];\n            }\n        }\n        return null;\n    } catch (err) {\n        console.error('Error fetching pages from Crossref:', err);\n        return null;\n    }\n}\n\n/**\n * Add pages to BibTeX if they're not already present\n */\nexport function addPagesToBibTeX(bibtex, pages) {\n    if (!pages) return bibtex;\n\n    // Check if pages field already exists\n    const pagesRegex = /pages\\s*=\\s*(?:\\{([^}]*)\\}|\"([^\"]*)\")/i;\n    const match = bibtex.match(pagesRegex);\n\n    if (match) {\n        // Update existing pages field\n        const currentPages = match[1] || match[2];\n        return bibtex.replace(match[0], `pages = {${pages}}`);\n    } else {\n        // Add pages field after the year field (common convention)\n        const yearRegex = /year\\s*=\\s*(?:\\{([^}]*)\\}|\"([^\"]*)\")/i;\n        const yearMatch = bibtex.match(yearRegex);\n\n        if (yearMatch) {\n            return bibtex.replace(yearMatch[0], `${yearMatch[0]},\\n  pages = {${pages}}`);\n        } else {\n            // If no year field, add pages after the first field\n            const firstFieldRegex = /(\\w+)\\s*=\\s*(?:\\{([^}]*)\\}|\"([^\"]*)\")/;\n            const firstMatch = bibtex.match(firstFieldRegex);\n\n            if (firstMatch) {\n                return bibtex.replace(firstMatch[0], `${firstMatch[0]},\\n  pages = {${pages}}`);\n            }\n        }\n    }\n\n    return bibtex;\n}\n\n/**\n * Parse BibTeX to extract bibliographic information\n */\nexport function parseBibTeX(bibtex) {\n    const result = {\n        title: '',\n        author: '',\n        journal: '',\n        year: '',\n        month: '',\n        volume: '',\n        number: '',\n        pages: ''\n    };\n\n    const fieldRegex = /(\\w+)\\s*=\\s*(?:\\{([^}]*)\\}|\"([^\"]*)\")/g;\n    let match;\n\n    while ((match = fieldRegex.exec(bibtex)) !== null) {\n        const field = match[1].toLowerCase();\n        const value = match[2] || match[3];\n\n        if (result.hasOwnProperty(field)) {\n            result[field] = value;\n        }\n    }\n\n    return result;\n}\n\n/**\n * Format authors for display\n */\nexport function formatAuthors(authorString) {\n    if (!authorString) return 'Unknown authors';\n\n    // Split by \"and\" and clean up each author\n    return authorString.split(/\\s+and\\s+/i).map(author => {\n        // Convert \"Last, First\" to \"First Last\"\n        const parts = author.split(',').map(p => p.trim()).filter(p => p);\n        if (parts.length >= 2) {\n            return `${parts[1]} ${parts[0]}`;\n        }\n        return author.trim();\n    }).join(', ');\n}\n\n/**\n * Generate a default key from BibTeX info (first author + year, with duplicate numbering)\n */\nexport function generateDefaultKey(bibInfo) {\n    const author = bibInfo.author || '';\n    const year = bibInfo.year || '';\n\n    // Get first author's last name\n    const firstAuthor = author.split(/\\s+and\\s+/i)[0] || '';\n    const lastName = firstAuthor.split(',')[0]?.trim() || 'Unknown';\n\n    // Remove non-alphabetic characters from last name and capitalize first letter\n    const cleanLastName = lastName.replace(/[^a-zA-Z]/g, '');\n    const keyBase = cleanLastName.charAt(0).toUpperCase() + cleanLastName.slice(1).toLowerCase() + year;\n\n    // Check for duplicates and add suffix if needed\n    let key = keyBase;\n    let suffix = 1;\n    const existingKeys = Object.keys(state.papersData);\n\n    while (existingKeys.includes(key)) {\n        key = keyBase + String.fromCharCode(96 + suffix);\n        suffix++;\n    }\n\n    return key;\n}\n\n/**\n * Add a paper by DOI\n */\nexport async function addPaperByDoi() {\n    const input = doiInput.value.trim();\n    const customKey = doiKeyInput.value.trim();\n\n    if (!input) {\n        const { showError } = await import('./ui/index.js');\n        showError('Please enter a DOI or URL');\n        return;\n    }\n\n    // Extract DOI from input\n    const doi = extractDOI(input);\n    if (!doi) {\n        const { showError } = await import('./ui/index.js');\n        showError('Could not extract a valid DOI from the input. Please enter a valid DOI (e.g., 10.xxxx/xxxx) or a URL containing a DOI.');\n        return;\n    }\n\n    try {\n        const { showStatus } = await import('./ui/index.js');\n        showStatus(`Fetching paper: ${doi}...`);\n\n        // Fetch BibTeX\n        const bibtex = await fetchBibTeX(doi);\n        if (!bibtex) {\n            const { showError } = await import('./ui/index.js');\n            showError('Failed to fetch BibTeX for this DOI');\n            return;\n        }\n\n        // Parse BibTeX\n        const bibInfo = parseBibTeX(bibtex);\n\n        // Generate or use custom key\n        const key = customKey || generateDefaultKey(bibInfo);\n\n        // Check if key already exists\n        if (state.papersData[key] && !customKey) {\n            const { showError } = await import('./ui/index.js');\n            showError(`Paper \"${key}\" already exists. Please provide a custom key or use a different DOI.`);\n            return;\n        } else if (state.papersData[key] && customKey) {\n            // User provided a custom key that already exists - warn and overwrite\n            if (!confirm(`The key \"${key}\" already exists. Do you want to overwrite the existing entry?`)) {\n                const { hideStatus } = await import('./ui/index.js');\n                hideStatus();\n                return;\n            }\n        }\n\n        // Fetch abstract\n        const abstract = await fetchAbstract(doi);\n\n        // Add to state.papersData\n        store.set({\n            papersData: {\n                ...state.papersData,\n                [key]: {\n                    _doi: doi,\n                    ...(bibInfo.title && { title: bibInfo.title }),\n                    ...(bibInfo.author && { author: bibInfo.author }),\n                    ...(bibInfo.journal && { journal: bibInfo.journal }),\n                    ...(bibInfo.year && { year: bibInfo.year }),\n                    ...(bibInfo.volume && { volume: bibInfo.volume }),\n                    ...(bibInfo.number && { number: bibInfo.number }),\n                    ...(bibInfo.pages && { pages: bibInfo.pages }),\n                }\n            }\n        });\n\n        // Add to processedPapersData\n        const processedEntry = {\n            key,\n            paper: {\n                _doi: doi,\n                ...(bibInfo.title && { title: bibInfo.title }),\n                ...(bibInfo.author && { author: bibInfo.author }),\n                ...(bibInfo.journal && { journal: bibInfo.journal }),\n                ...(bibInfo.year && { year: bibInfo.year }),\n                ...(bibInfo.volume && { volume: bibInfo.volume }),\n                ...(bibInfo.number && { number: bibInfo.number }),\n                ...(bibInfo.pages && { pages: bibInfo.pages }),\n            },\n            bibInfo: { title: bibInfo.title || key, ...bibInfo },\n            abstract\n        };\n        store.set({\n            processedPapersData: [...state.processedPapersData, processedEntry]\n        });\n\n        // Re-render papers\n        applyTagFilter();\n\n        // Show export and papers sections if this is the first paper\n        if (Object.keys(state.papersData).length === 1) {\n            loadJsonSection.style.display = 'none';\n            saveJsonSection.style.display = 'block';\n            exportResetSection.style.display = 'block';\n            papersSection.style.display = 'block';\n        }\n\n        // Clear inputs\n        doiInput.value = '';\n        doiKeyInput.value = '';\n\n        showStatus(`Paper \"${key}\" added successfully`);\n\n        // Scroll to the new paper\n        setTimeout(() => {\n            const newCard = document.querySelector(`.paper[data-key=\"${key}\"]`);\n            if (newCard) {\n                newCard.scrollIntoView({ behavior: 'smooth', block: 'center' });\n                newCard.classList.add('paper--highlight');\n                setTimeout(() => newCard.classList.remove('paper--highlight'), 2000);\n            }\n        }, 100);\n\n    } catch (err) {\n        console.error('Error adding paper:', err);\n        const { showError } = await import('./ui/index.js');\n        showError('Error adding paper: ' + err.message);\n    }\n}\n\n/**\n * Create paper card element\n */\nexport function createPaperCard(key, paperData, bibInfo, abstract) {\n    const card = document.createElement('article');\n    card.className = 'paper';\n    card.dataset.key = key;\n\n    // Import escapeHtml synchronously - it's needed immediately\n    const escapeHtmlStr = (text) => {\n        if (!text) return '';\n        const div = document.createElement('div');\n        div.textContent = text;\n        return div.innerHTML;\n    };\n\n    const tags = (paperData._tags || []).map(tag =>\n        `<button type=\"button\" class=\"tag\" data-tag=\"${tag}\" aria-pressed=\"false\" tabindex=\"0\">${tag}</button>`\n    ).join('');\n\n    const alsoread = (paperData._alsoread || []).map(ref =>\n        `<button type=\"button\" class=\"also-read__link\" data-ref=\"${ref}\" tabindex=\"0\" aria-label=\"View paper: ${ref}\">${ref}</button>`\n    ).join('');\n\n    const comments = `<textarea class=\"comments\" placeholder=\"Add your notes...\" data-key=\"${key}\" aria-label=\"Notes for this paper\">${paperData._comments || ''}</textarea>`;\n\n    const abstractContent = abstract ? `<div class=\"abstract__content\">${escapeHtmlStr(abstract)}</div>` : '<p class=\"abstract__empty\">No abstract available</p>';\n\n    // Build compact citation line\n    const citationParts = [];\n    if (formatAuthors(bibInfo.author)) {\n        citationParts.push(`<span class=\"citation__authors\">${formatAuthors(bibInfo.author)}</span>`);\n    }\n    if (escapeHtmlStr(bibInfo.journal)) {\n        citationParts.push(`<span class=\"citation__journal\">${escapeHtmlStr(bibInfo.journal)}</span>`);\n    }\n    if (bibInfo.year) {\n        citationParts.push(`<span class=\"citation__year\">${bibInfo.year}</span>`);\n    }\n    if (bibInfo.volume) {\n        citationParts.push(`<span class=\"citation__volume\">Vol. ${bibInfo.volume}</span>`);\n    }\n    if (bibInfo.number) {\n        citationParts.push(`<span class=\"citation__number\">No. ${bibInfo.number}</span>`);\n    }\n    if (bibInfo.pages) {\n        citationParts.push(`<span class=\"citation__pages\">pp. ${bibInfo.pages}</span>`);\n    }\n    if (paperData._doi) {\n        citationParts.push(`<a href=\"https://doi.org/${paperData._doi}\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"citation__link\">DOI: ${paperData._doi}</a>`);\n    }\n    const citationLine = citationParts.join(' ');\n\n    card.innerHTML = `\n        <div class=\"paper__header\">\n            <h3 class=\"paper__title\">${escapeHtmlStr(bibInfo.title || key)}</h3>\n        </div>\n        <p class=\"citation\">${citationLine}</p>\n        ${comments}\n        <div class=\"tags\">\n            <button class=\"tag-edit-btn\" aria-label=\"Edit tags\" type=\"button\" data-key=\"${key}\">\n                <svg class=\"tag-edit-btn__icon\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" aria-hidden=\"true\">\n                    <path d=\"M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z\"></path>\n                </svg>\n            </button>\n            ${tags}\n        </div>\n        ${alsoread ? `<div class=\"also-read\" role=\"group\" aria-label=\"Also read papers\"><span class=\"also-read__label\">Also read:</span> ${alsoread}</div>` : ''}\n        <button class=\"abstract-toggle\" aria-expanded=\"false\" aria-label=\"Toggle abstract\" type=\"button\">\n            <svg class=\"abstract-toggle__icon\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" aria-hidden=\"true\">\n                <path d=\"M6 9l6 6 6-6\"/>\n            </svg>\n            Abstract\n        </button>\n        <div class=\"abstract\" aria-hidden=\"true\">\n            ${abstractContent}\n        </div>\n    `;\n\n    // Abstract toggle functionality\n    const toggleBtn = card.querySelector('.abstract-toggle');\n    const abstractContainer = card.querySelector('.abstract');\n\n    toggleBtn.addEventListener('click', () => {\n        const isExpanded = toggleBtn.getAttribute('aria-expanded') === 'true';\n        toggleBtn.setAttribute('aria-expanded', !isExpanded);\n        abstractContainer.classList.toggle('abstract--expanded');\n        abstractContainer.setAttribute('aria-hidden', isExpanded);\n        toggleBtn.querySelector('svg').style.transform = isExpanded ? 'rotate(0deg)' : 'rotate(180deg)';\n    });\n\n    // Also read link click handler\n    card.querySelectorAll('.also-read__link').forEach(link => {\n        const handleClick = () => {\n            const refKey = link.dataset.ref;\n            const refCard = document.querySelector(`.paper[data-key=\"${refKey}\"]`);\n            if (refCard) {\n                refCard.scrollIntoView({ behavior: 'smooth', block: 'center' });\n                refCard.classList.add('paper--highlight');\n                refCard.focus();\n                setTimeout(() => refCard.classList.remove('paper--highlight'), 2000);\n            } else {\n                import('./ui/index.js').then(({ showError }) => {\n                    showError(`Paper \"${refKey}\" not found in current view`);\n                });\n            }\n        };\n        link.addEventListener('click', handleClick);\n        link.addEventListener('keydown', (e) => {\n            if (e.key === 'Enter' || e.key === ' ') {\n                e.preventDefault();\n                handleClick();\n            }\n        });\n    });\n\n    // Tag click handler\n    card.querySelectorAll('.tag').forEach(tag => {\n        const handleClick = () => {\n            import('./ui/index.js').then(({ toggleTag }) => {\n                toggleTag(tag.dataset.tag);\n            });\n        };\n        tag.addEventListener('click', handleClick);\n        tag.addEventListener('keydown', (e) => {\n            if (e.key === 'Enter' || e.key === ' ') {\n                e.preventDefault();\n                handleClick();\n            }\n        });\n    });\n\n    return card;\n}\n\n/**\n * Process papers data - fetch BibTeX and abstracts\n */\nexport async function processPapers(data) {\n    store.set({ papersData: data });\n    const entries = Object.entries(data);\n\n    const { showStatus } = await import('./ui/index.js');\n    showStatus(`Processing ${entries.length} papers...`);\n\n    // Force UI update before starting the loop\n    await new Promise(resolve => setTimeout(resolve, 0));\n\n    const processed = [];\n\n    for (let i = 0; i < entries.length; i++) {\n        const [key, paper] = entries[i];\n        status.textContent = `Fetching ${i + 1} of ${entries.length}: ${key}`;\n        // Force UI update before async operations\n        await new Promise(resolve => setTimeout(resolve, 0));\n\n        const result = {\n            key,\n            paper,\n            bibInfo: { title: key },\n            abstract: null\n        };\n\n        if (paper._doi) {\n            const bibtex = await fetchBibTeX(paper._doi);\n            if (bibtex) {\n                result.bibInfo = parseBibTeX(bibtex);\n                // Check if BibTeX has page numbers\n                let pages = result.bibInfo.pages;\n                if (!pages) {\n                    // Try Crossref API for page numbers\n                    pages = await fetchPagesFromCrossref(paper._doi);\n                    if (pages) {\n                        result.bibInfo.pages = pages;\n                    }\n                }\n            }\n\n            const abstract = await fetchAbstract(paper._doi);\n            if (abstract) {\n                result.abstract = abstract;\n            }\n        }\n\n        processed.push(result);\n\n        // Rate limiting - delay between requests\n        if (i < entries.length - 1) {\n            await new Promise(resolve => setTimeout(resolve, 1000));\n        }\n    }\n\n    return processed;\n}\n\n/**\n * Display papers (process and render)\n */\nexport async function displayPapers() {\n    const processedPapers = await processPapers(state.papersData);\n    renderPapers(processedPapers);\n\n    // Hide load section, show papers and export sections\n    loadJsonSection.style.display = 'none';\n    papersSection.style.display = 'block';\n    saveJsonSection.style.display = 'block';\n    exportResetSection.style.display = 'block';\n}\n\n/**\n * Render papers\n */\nexport function renderPapers(processedPapers) {\n    // Store processed papers for filtering\n    store.set({ processedPapersData: processedPapers });\n    applyTagFilter();\n}\n\n/**\n * Filter and reorder papers based on selected tags\n */\nexport function applyTagFilter() {\n    papersList.innerHTML = '';\n\n    if (state.processedPapersData.length === 0) {\n        papersList.innerHTML = '<p class=\"no-papers\">No papers found in the loaded data.</p>';\n        return;\n    }\n\n    // Sort papers: matching papers first, non-matching last\n    const sortedPapers = [...state.processedPapersData].sort((a, b) => {\n        const aHasSelectedTag = hasSelectedTag(a.paper);\n        const bHasSelectedTag = hasSelectedTag(b.paper);\n\n        if (aHasSelectedTag && !bHasSelectedTag) return -1;\n        if (!aHasSelectedTag && bHasSelectedTag) return 1;\n        return 0;\n    });\n\n    sortedPapers.forEach(({ key, paper, bibInfo, abstract }) => {\n        const card = createPaperCard(key, paper, bibInfo, abstract);\n\n        // Add dimmed class if no selected tags\n        if (state.selectedTags.size > 0 && !hasSelectedTag(paper)) {\n            card.classList.add('paper--dimmed');\n        }\n\n        papersList.appendChild(card);\n    });\n\n    // Update tag visual states after rendering\n    updateTagVisuals();\n\n    // Update export button states\n    import('./ui/index.js').then(({ updateExportButtonStates }) => {\n        updateExportButtonStates();\n    });\n}\n\n/**\n * Check if a paper has any selected tag\n */\nexport function hasSelectedTag(paper) {\n    const paperTags = paper._tags || [];\n    if (state.selectedTags.size === 0) return true; // No tags selected, all papers are \"matching\"\n    return paperTags.some(tag => state.selectedTags.has(tag));\n}\n\n/**\n * Update visual state of all tags (selected/deselected)\n */\nexport function updateTagVisuals() {\n    document.querySelectorAll('.tag').forEach(tagElement => {\n        const tag = tagElement.dataset.tag;\n        if (state.selectedTags.size === 0) {\n            // No tags selected - remove all classes\n            tagElement.classList.remove('tag--selected', 'tag--deselected');\n            tagElement.setAttribute('aria-pressed', 'false');\n        } else if (state.selectedTags.has(tag)) {\n            tagElement.classList.add('tag--selected');\n            tagElement.classList.remove('tag--deselected');\n            tagElement.setAttribute('aria-pressed', 'true');\n        } else {\n            tagElement.classList.add('tag--deselected');\n            tagElement.classList.remove('tag--selected');\n            tagElement.setAttribute('aria-pressed', 'false');\n        }\n    });\n}\n\n// Initialize event listeners - must be called after initDOM()\nexport function initEventListeners() {\n    console.log('[Papers] Initializing event listeners');\n\n    // Add DOI button click handler\n    if (addDoiBtn) {\n        addDoiBtn.addEventListener('click', () => {\n            addPaperByDoi();\n        });\n    }\n\n    // Allow Enter key to submit DOI\n    if (doiInput) {\n        doiInput.addEventListener('keydown', (e) => {\n            if (e.key === 'Enter') {\n                e.preventDefault();\n                addPaperByDoi();\n            }\n        });\n    }\n\n    console.log('[Papers] Event listeners initialized');\n}", "// Storage module - data persistence\n\nimport { state, store } from '../state.js';\nimport { showError, showStatus } from './notifications.js';\nimport { get } from '../dom.js';\n\nlet papersList;\nlet jsonFormatSelector;\n\nexport function initStorageDOM() {\n    papersList = get('papersList');\n    jsonFormatSelector = get('jsonFormatSelector');\n}\n\n/**\n * Clear current papers data\n */\nexport function clearCurrentData() {\n    store.set({\n        papersData: {},\n        selectedTags: new Set(),\n        processedPapersData: []\n    });\n    if (papersList) {\n        papersList.innerHTML = '';\n    }\n}\n\n/**\n * Save papers data to browser storage\n */\nexport function saveToStorage() {\n    if (!state.papersData || Object.keys(state.papersData).length === 0) {\n        showError('No papers to save');\n        return;\n    }\n\n    try {\n        // Get the format (full or light)\n        const format = jsonFormatSelector ? jsonFormatSelector.value : 'full';\n        let dataToSave = state.papersData;\n\n        if (format === 'light') {\n            dataToSave = {};\n            for (const [key, paper] of Object.entries(state.papersData)) {\n                dataToSave[key] = {\n                    _doi: paper._doi,\n                    _comments: paper._comments || [],\n                    _tags: paper._tags || [],\n                    _alsoread: paper._alsoread || []\n                };\n            }\n        }\n\n        const jsonStr = JSON.stringify(dataToSave);\n        localStorage.setItem('argonautPapers', jsonStr);\n        showStatus('Papers saved to browser storage');\n    } catch (err) {\n        console.error('Error saving to storage:', err);\n        showError('Error saving to storage: ' + err.message);\n    }\n}\n\n/**\n * Load papers data from browser storage\n */\nexport async function loadFromStorage() {\n    try {\n        const jsonStr = localStorage.getItem('argonautPapers');\n        if (!jsonStr) {\n            showError('No papers found in browser storage');\n            return;\n        }\n\n        const data = JSON.parse(jsonStr);\n        if (!data || Object.keys(data).length === 0) {\n            showError('No papers found in browser storage');\n            return;\n        }\n\n        // Clear current data and load new data\n        clearCurrentData();\n        store.set({ papersData: data });\n        const { displayPapers } = await import('../papers.js');\n        displayPapers();\n        showStatus(`Loaded ${Object.keys(data).length} papers from browser storage`);\n    } catch (err) {\n        console.error('Error loading from storage:', err);\n        showError('Error loading from storage: ' + err.message);\n    }\n}\n", "// Export module - file export functions\n\nimport { state } from '../state.js';\nimport { showError, showStatus } from './notifications.js';\nimport { get } from '../dom.js';\n\nlet jsonFormatSelector;\nlet status;\n\nexport function initExportDOM() {\n    jsonFormatSelector = get('jsonFormatSelector');\n    status = get('status');\n}\n\n/**\n * Save file using File System Access API with fallback\n */\nexport async function saveFileWithPicker(content, defaultFilename, mimeType) {\n    console.log('[Export] saveFileWithPicker called');\n    console.log('[Export] showSaveFilePicker in window:', 'showSaveFilePicker' in window);\n    console.log('[Export] defaultFilename:', defaultFilename);\n\n    // Check if File System Access API is supported\n    if ('showSaveFilePicker' in window) {\n        console.log('[Export] Using File System Access API');\n        try {\n            console.log('[Export] Calling showSaveFilePicker...');\n            const fileHandle = await window.showSaveFilePicker({\n                suggestedName: defaultFilename,\n                types: [{\n                    description: getMimeTypeDescription(mimeType),\n                    accept: { [mimeType]: getMimeTypeExtensions(mimeType) }\n                }]\n            });\n            const writable = await fileHandle.createWritable();\n            await writable.write(content);\n            await writable.close();\n            return true;\n        } catch (err) {\n            // User cancelled the dialog - not an error\n            if (err.name === 'AbortError') {\n                return false;\n            }\n            throw err;\n        }\n    } else {\n        // Fallback for browsers without File System Access API\n        const blob = new Blob([content], { type: mimeType });\n        const url = URL.createObjectURL(blob);\n        const a = document.createElement('a');\n        a.href = url;\n        a.download = defaultFilename;\n        a.style.display = 'none';\n        document.body.appendChild(a);\n        a.click();\n        document.body.removeChild(a);\n        URL.revokeObjectURL(url);\n        return true;\n    }\n}\n\n/**\n * Get file description based on MIME type\n */\nexport function getMimeTypeDescription(mimeType) {\n    switch (mimeType) {\n        case 'application/json':\n            return 'JSON File';\n        case 'text/plain':\n        case 'text/x-bibtex':\n            return 'BibTeX File';\n        default:\n            return 'File';\n    }\n}\n\n/**\n * Get file extensions based on MIME type\n */\nexport function getMimeTypeExtensions(mimeType) {\n    switch (mimeType) {\n        case 'application/json':\n            return ['.json'];\n        case 'text/plain':\n        case 'text/x-bibtex':\n            return ['.bib', '.txt'];\n        default:\n            return ['.*'];\n    }\n}\n\n/**\n * Export papers data as JSON\n */\nexport async function exportJSON() {\n    console.log('[Export] exportJSON called');\n    console.log('[Export] state.papersData:', state.papersData);\n    console.log('[Export] showSaveFilePicker available:', 'showSaveFilePicker' in window);\n\n    if (!state.papersData || Object.keys(state.papersData).length === 0) {\n        showError('No papers to export');\n        return;\n    }\n\n    try {\n        // Get the format (full or light)\n        const format = jsonFormatSelector ? jsonFormatSelector.value : 'full';\n        console.log('[Export] format:', format);\n        let dataToSave = state.papersData;\n        let filename = 'papers.json';\n\n        if (format === 'light') {\n            dataToSave = {};\n            for (const [key, paper] of Object.entries(state.papersData)) {\n                dataToSave[key] = {\n                    _doi: paper._doi,\n                    _comments: paper._comments || [],\n                    _tags: paper._tags || [],\n                    _alsoread: paper._alsoread || []\n                };\n            }\n            filename = 'papers-light.json';\n        }\n\n        const jsonStr = JSON.stringify(dataToSave, null, 2);\n        const saved = await saveFileWithPicker(jsonStr, filename, 'application/json');\n        if (saved) {\n            showStatus('JSON exported successfully');\n        }\n    } catch (err) {\n        console.error('Error exporting JSON:', err);\n        showError('Error exporting JSON: ' + err.message);\n    }\n}\n\n/**\n * Export papers data as JSON (light version)\n */\nexport async function exportJSONLight() {\n    if (!state.papersData || Object.keys(state.papersData).length === 0) {\n        showError('No papers to export');\n        return;\n    }\n\n    try {\n        const lightData = {};\n        for (const [key, paper] of Object.entries(state.papersData)) {\n            lightData[key] = {\n                _doi: paper._doi,\n                _comments: paper._comments,\n                _tags: paper._tags,\n                _alsoread: paper._alsoread\n            };\n        }\n        const jsonStr = JSON.stringify(lightData, null, 2);\n        const saved = await saveFileWithPicker(jsonStr, 'papers-light.json', 'application/json');\n        if (saved) {\n            showStatus('JSON (light) exported successfully');\n        }\n    } catch (err) {\n        console.error('Error exporting JSON (light):', err);\n        showError('Error exporting JSON (light): ' + err.message);\n    }\n}\n\n/**\n * Export papers as BibTeX\n */\nexport async function exportBibTeX() {\n    if (!state.papersData || Object.keys(state.papersData).length === 0) {\n        showError('No papers to export');\n        return;\n    }\n\n    try {\n        const { fetchBibTeX, fetchPagesFromCrossref, addPagesToBibTeX, parseBibTeX } = await import('../papers.js');\n\n        showStatus('Fetching BibTeX entries...');\n\n        const entries = Object.entries(state.papersData);\n        let bibtexContent = '';\n\n        for (let i = 0; i < entries.length; i++) {\n            const [key, paper] = entries[i];\n            if (status) {\n                status.textContent = `Fetching BibTeX ${i + 1} of ${entries.length}: ${key}`;\n            }\n            await new Promise(resolve => setTimeout(resolve, 0));\n\n            if (paper._doi) {\n                let bibtex = await fetchBibTeX(paper._doi);\n                if (bibtex) {\n                    // Check if BibTeX has page numbers\n                    const parsed = parseBibTeX(bibtex);\n                    let pages = parsed.pages;\n\n                    if (!pages) {\n                        // Try Crossref API for page numbers\n                        pages = await fetchPagesFromCrossref(paper._doi);\n                    }\n\n                    if (pages) {\n                        bibtex = addPagesToBibTeX(bibtex, pages);\n                    }\n\n                    bibtexContent += bibtex + '\\n\\n';\n                } else {\n                    // Fallback entry if BibTeX fetch fails\n                    bibtexContent += `@misc{${key.replace(/\\s+/g, '')},\\n  title = {${key}},\\n  doi = {${paper._doi}}\\n}\\n\\n`;\n                }\n            } else {\n                // Fallback entry for papers without DOI\n                bibtexContent += `@misc{${key.replace(/\\s+/g, '')},\\n  title = {${key}}\\n}\\n\\n`;\n            }\n\n            // Rate limiting\n            if (i < entries.length - 1) {\n                await new Promise(resolve => setTimeout(resolve, 1000));\n            }\n        }\n\n        const saved = await saveFileWithPicker(bibtexContent, 'papers.bib', 'text/x-bibtex');\n        if (saved) {\n            showStatus(`BibTeX exported successfully (${entries.length} entries)`);\n        }\n    } catch (err) {\n        console.error('Error exporting BibTeX:', err);\n        showError('Error exporting BibTeX: ' + err.message);\n    }\n}\n\n/**\n * Export papers with selected tags as BibTeX\n */\nexport async function exportBibTeXTagged() {\n    if (!state.papersData || Object.keys(state.papersData).length === 0) {\n        showError('No papers to export');\n        return;\n    }\n\n    if (state.selectedTags.size === 0) {\n        showError('Please select at least one tag first');\n        return;\n    }\n\n    try {\n        const { fetchBibTeX, fetchPagesFromCrossref, addPagesToBibTeX, parseBibTeX } = await import('../papers.js');\n\n        showStatus('Fetching BibTeX entries for tagged papers...');\n\n        // Filter entries to only include papers with selected tags\n        const entries = Object.entries(state.papersData).filter(([key, paper]) => {\n            const paperTags = paper._tags || [];\n            return paperTags.some(tag => state.selectedTags.has(tag));\n        });\n\n        if (entries.length === 0) {\n            showError('No papers found with the selected tags');\n            return;\n        }\n\n        let bibtexContent = '';\n\n        for (let i = 0; i < entries.length; i++) {\n            const [key, paper] = entries[i];\n            if (status) {\n                status.textContent = `Fetching BibTeX ${i + 1} of ${entries.length}: ${key}`;\n            }\n            await new Promise(resolve => setTimeout(resolve, 0));\n\n            if (paper._doi) {\n                let bibtex = await fetchBibTeX(paper._doi);\n                if (bibtex) {\n                    // Check if BibTeX has page numbers\n                    const parsed = parseBibTeX(bibtex);\n                    let pages = parsed.pages;\n\n                    if (!pages) {\n                        // Try Crossref API for page numbers\n                        pages = await fetchPagesFromCrossref(paper._doi);\n                    }\n\n                    if (pages) {\n                        bibtex = addPagesToBibTeX(bibtex, pages);\n                    }\n\n                    bibtexContent += bibtex + '\\n\\n';\n                } else {\n                    // Fallback entry if BibTeX fetch fails\n                    bibtexContent += `@misc{${key.replace(/\\s+/g, '')},\\n  title = {${key}},\\n  doi = {${paper._doi}}\\n}\\n\\n`;\n                }\n            } else {\n                // Fallback entry for papers without DOI\n                bibtexContent += `@misc{${key.replace(/\\s+/g, '')},\\n  title = {${key}}\\n}\\n\\n`;\n            }\n\n            // Rate limiting\n            if (i < entries.length - 1) {\n                await new Promise(resolve => setTimeout(resolve, 1000));\n            }\n        }\n\n        const saved = await saveFileWithPicker(bibtexContent, 'papers-tagged.bib', 'text/x-bibtex');\n        if (saved) {\n            showStatus(`BibTeX exported successfully (${entries.length} entries with selected tags)`);\n        }\n    } catch (err) {\n        console.error('Error exporting BibTeX:', err);\n        showError('Error exporting BibTeX: ' + err.message);\n    }\n}\n", "// Load module - load papers from file/URL\n\nimport { showError, showStatus, hideStatus, hideError } from './notifications.js';\nimport { get } from '../dom.js';\n\nlet papersList;\nlet fileInput;\nlet urlInput;\nlet loadJsonSection;\nlet saveJsonSection;\nlet exportResetSection;\nlet papersSection;\n\nexport function initLoadDOM() {\n    papersList = get('papersList');\n    fileInput = get('fileInput');\n    urlInput = get('urlInput');\n    loadJsonSection = get('loadJsonSection');\n    saveJsonSection = get('saveJsonSection');\n    exportResetSection = get('exportResetSection');\n    papersSection = get('papersSection');\n}\n\n/**\n * Load JSON from file\n */\nexport function loadFromFile(file) {\n    return new Promise((resolve, reject) => {\n        const reader = new FileReader();\n        reader.onload = (e) => {\n            try {\n                const data = JSON.parse(e.target.result);\n                resolve(data);\n            } catch (err) {\n                reject(new Error('Invalid JSON file'));\n            }\n        };\n        reader.onerror = () => reject(new Error('Error reading file'));\n        reader.readAsText(file);\n    });\n}\n\n/**\n * Load JSON from URL\n */\nexport async function loadFromUrl(url) {\n    try {\n        const response = await fetch(url);\n        if (!response.ok) {\n            throw new Error(`Failed to load: ${response.status}`);\n        }\n        return await response.json();\n    } catch (err) {\n        throw new Error(`Error loading from URL: ${err.message}`);\n    }\n}\n\n/**\n * Load default papers.json\n */\nexport async function loadDefault() {\n    try {\n        const response = await fetch('papers.json');\n        if (!response.ok) {\n            throw new Error('papers.json not found');\n        }\n        return await response.json();\n    } catch (err) {\n        throw new Error('Error loading default papers: ' + err.message);\n    }\n}\n\n/**\n * Main load function\n */\nexport async function loadPapers(method) {\n    hideError();\n    hideStatus();\n    if (papersList) {\n        papersList.innerHTML = '<p class=\"loading\">Loading papers...</p>';\n    }\n\n    try {\n        let data;\n\n        switch (method) {\n            case 'file':\n                if (!fileInput || !fileInput.files[0]) {\n                    throw new Error('Please select a file');\n                }\n                showStatus('Loading papers from file...');\n                data = await loadFromFile(fileInput.files[0]);\n                break;\n            case 'url':\n                if (!urlInput) {\n                    throw new Error('URL input not found');\n                }\n                const url = urlInput.value.trim();\n                if (!url) {\n                    throw new Error('Please enter a URL');\n                }\n                showStatus('Loading papers from URL...');\n                data = await loadFromUrl(url);\n                break;\n            case 'default':\n                data = await loadDefault();\n                break;\n            default:\n                throw new Error('Invalid input method');\n        }\n\n        const { processPapers } = await import('../papers.js');\n        const processedPapers = await processPapers(data);\n        const { renderPapers } = await import('../papers.js');\n        renderPapers(processedPapers);\n\n        // Switch to papers view\n        if (loadJsonSection) loadJsonSection.style.display = 'none';\n        if (saveJsonSection) saveJsonSection.style.display = 'block';\n        if (exportResetSection) exportResetSection.style.display = 'block';\n        if (papersSection) papersSection.style.display = 'block';\n        showStatus(`Loaded ${processedPapers.length} papers successfully`);\n        setTimeout(hideStatus, 3000);\n\n    } catch (err) {\n        showError(err.message);\n        if (papersList) {\n            papersList.innerHTML = '';\n        }\n    }\n}\n", "// Input options module - input/save option UI\n\nimport { getSessionId } from '../auth.js';\nimport { loadPapers } from './load.js';\nimport { get } from '../dom.js';\n\nlet urlInput;\n\nexport function initInputOptionsDOM() {\n    urlInput = get('urlInput');\n}\n\n/**\n * Update input option UI state\n */\nexport function updateInputOptionUI(selectedValue) {\n    console.log('updateInputOptionUI: selectedValue =', selectedValue);\n\n    // Hide all option contents and remove active class\n    document.querySelectorAll('.input-section__option').forEach(option => {\n        option.classList.remove('input-section__option--active');\n        const content = option.querySelector('.input-section__content');\n        if (content) {\n            content.style.display = 'none';\n        }\n    });\n\n    // Show the selected option\n    const selectedOption = document.querySelector(`.input-section__option[data-input=\"${selectedValue}\"]`);\n    console.log('updateInputOptionUI: selectedOption =', selectedOption);\n\n    if (selectedOption) {\n        selectedOption.classList.add('input-section__option--active');\n        const selectedContent = selectedOption.querySelector('.input-section__content');\n        console.log('updateInputOptionUI: selectedContent =', selectedContent);\n        if (selectedContent) {\n            selectedContent.style.display = 'block';\n        }\n\n        // Load gist options if \"gist\" is selected and user is authenticated\n        if (selectedValue === 'gist' && getSessionId()) {\n            import('../github.js').then(({ loadGistOptionsForLoadSelector }) => {\n                loadGistOptionsForLoadSelector();\n            });\n            import('../auth.js').then(({ updateGistVisibility }) => {\n                updateGistVisibility();\n            });\n        }\n    }\n}\n\n/**\n * Initialize input option state on page load\n */\nexport function initInputOptions() {\n    const selectedRadio = document.querySelector('input[name=\"inputMethod\"]:checked');\n    console.log('initInputOptions: selectedRadio =', selectedRadio?.id);\n\n    if (selectedRadio) {\n        // Update UI state directly to ensure proper display\n        updateInputOptionUI(selectedRadio.value);\n    } else {\n        // Default to \"url\" if nothing is selected\n        const urlRadio = document.getElementById('inputMethodUrl');\n        if (urlRadio) {\n            urlRadio.checked = true;\n            updateInputOptionUI('url');\n        }\n    }\n\n    // Check for inputURL parameter and auto-load\n    checkInputURLParameter();\n}\n\n/**\n * Check for inputURL parameter and auto-load\n */\nfunction checkInputURLParameter() {\n    const urlParams = new URLSearchParams(window.location.search);\n    const inputURL = urlParams.get('inputURL');\n\n    if (inputURL) {\n        console.log('[URL Parameter] Found inputURL:', inputURL);\n        // Update the URL input field\n        if (urlInput) {\n            urlInput.value = inputURL;\n        }\n        // Select the URL option\n        const urlRadio = document.getElementById('inputMethodUrl');\n        if (urlRadio) {\n            urlRadio.checked = true;\n            updateInputOptionUI('url');\n        }\n        // Auto-load the papers\n        setTimeout(() => {\n            loadPapers('url');\n        }, 100);\n        // Clean up URL parameter after loading\n        window.history.replaceState({}, document.title, window.location.pathname);\n    }\n}\n", "// Save options module - save option UI\n\nimport { getSessionId } from '../auth.js';\n\n/**\n * Update save option UI state\n */\nexport function updateSaveOptionUI(selectedValue) {\n    console.log('updateSaveOptionUI: selectedValue =', selectedValue);\n\n    // Hide all option contents and remove active class\n    document.querySelectorAll('.save-section__option').forEach(option => {\n        option.classList.remove('save-section__option--active');\n        const content = option.querySelector('.save-section__option-content');\n        if (content) {\n            content.style.display = 'none';\n        }\n    });\n\n    // Show the selected option\n    const selectedOption = document.querySelector(`.save-section__option[data-save=\"${selectedValue}\"]`);\n    console.log('updateSaveOptionUI: selectedOption =', selectedOption);\n\n    if (selectedOption) {\n        selectedOption.classList.add('save-section__option--active');\n        const selectedContent = selectedOption.querySelector('.save-section__option-content');\n        console.log('updateSaveOptionUI: selectedContent =', selectedContent);\n        if (selectedContent) {\n            selectedContent.style.display = 'block';\n        }\n\n        // Load gist options if \"gist\" is selected and user is authenticated\n        if (selectedValue === 'gist' && getSessionId()) {\n            import('../github.js').then(({ loadGistOptionsForSaveSelector }) => {\n                loadGistOptionsForSaveSelector();\n            });\n            import('../auth.js').then(({ updateSaveGistVisibility }) => {\n                updateSaveGistVisibility();\n            });\n        }\n    }\n}\n\n/**\n * Initialize save option state on page load\n */\nexport function initSaveOptions() {\n    const selectedRadio = document.querySelector('input[name=\"saveMethod\"]:checked');\n    console.log('initSaveOptions: selectedRadio =', selectedRadio?.id);\n\n    if (selectedRadio) {\n        // Update UI state directly to ensure proper display\n        updateSaveOptionUI(selectedRadio.value);\n    } else {\n        // Default to \"file\" if nothing is selected\n        const fileRadio = document.getElementById('saveMethodFile');\n        if (fileRadio) {\n            fileRadio.checked = true;\n            updateSaveOptionUI('file');\n        }\n    }\n}\n", "// Tag editor module - inline tag editing\n\nimport { state, store } from '../state.js';\nimport { showError, showStatus } from './notifications.js';\nimport { get } from '../dom.js';\n\nlet exportBibtexTaggedBtn;\n\nexport function initTagEditorDOM() {\n    exportBibtexTaggedBtn = get('exportBibtexTaggedBtn');\n}\n\n/**\n * Update disabled state of export buttons based on tag selection\n */\nexport function updateExportButtonStates() {\n    if (exportBibtexTaggedBtn) {\n        exportBibtexTaggedBtn.disabled = state.selectedTags.size === 0;\n    }\n}\n\n/**\n * Toggle tag selection and filter papers\n */\nexport function toggleTag(tag) {\n    const newTags = [...state.selectedTags];\n    const index = newTags.indexOf(tag);\n    if (index > -1) {\n        newTags.splice(index, 1); // Remove\n    } else {\n        newTags.push(tag); // Add\n    }\n    store.setSelectedTags(newTags);\n    import('../papers.js').then(({ applyTagFilter }) => {\n        applyTagFilter();\n        updateExportButtonStates();\n    });\n}\n\n/**\n * Check if there are unsaved changes\n */\nexport function hasUnsavedChanges() {\n    const paper = state.papersData[state.currentEditingKey];\n    if (!paper) return false;\n    const originalTags = paper._tags || [];\n    const finalTags = [...state.tentativeTags];\n    // Check if tags have changed\n    if (originalTags.length !== finalTags.length) return true;\n    for (let i = 0; i < originalTags.length; i++) {\n        if (originalTags[i] !== finalTags[i]) return true;\n    }\n    return false;\n}\n\n/**\n * Open inline tag editing\n */\nexport function openTagDialog(key) {\n    console.log('openTagDialog called with key:', key);\n\n    // Prevent editing multiple papers at once\n    if (state.currentEditingKey !== null && state.currentEditingKey !== key) {\n        if (hasUnsavedChanges() && !confirm('You have unsaved changes. Discard them?')) {\n            return;\n        }\n        closeTagDialog();\n    }\n\n    store.set({ currentEditingKey: key });\n    const paper = state.papersData[key];\n    if (!paper) {\n        console.error('Paper not found for key:', key);\n        return;\n    }\n\n    // Reset state\n    store.set({\n        tentativeTags: [],\n        tentativeTagsRemoved: []\n    });\n\n    // Initialize tags from paper\n    const existingTags = paper._tags || [];\n    existingTags.forEach(tag => {\n        // Ensure tag is a string (not an object)\n        const tagString = typeof tag === 'object' ? JSON.stringify(tag) : String(tag);\n        state.tentativeTags.push(tagString);\n    });\n\n    // Find the card and tags container - try both selector patterns\n    let card = document.querySelector(`.paper[data-key=\"${key}\"]`);\n    if (!card) {\n        card = document.querySelector(`.paper-card[data-key=\"${key}\"]`);\n    }\n    if (!card) {\n        console.error('Card not found for key:', key);\n        return;\n    }\n\n    // Try different selectors for tags container\n    let tagsContainer = card.querySelector('.tags');\n    if (!tagsContainer) {\n        tagsContainer = card.querySelector('.tags-container');\n    }\n    if (!tagsContainer) {\n        // Try finding tags element within the card\n        tagsContainer = card.querySelector('[class*=\"tags\"]');\n    }\n    if (!tagsContainer) {\n        console.error('tags not found for key:', key);\n        return;\n    }\n\n    // Add editing class for visual distinction\n    tagsContainer.classList.add('tags--editing');\n\n    // Store original content\n    tagsContainer.dataset.originalContent = tagsContainer.innerHTML;\n\n    // Render inline editing interface\n    renderInlineTagEditor(tagsContainer);\n}\n\n/**\n * Render inline tag editor\n */\nfunction renderInlineTagEditor(tagsContainer) {\n    console.log('renderInlineTagEditor called');\n\n    // Build tags HTML\n    let tagsHtml = '';\n    if (state.tentativeTags.length === 0 && state.tentativeTagsRemoved.length === 0) {\n        tagsHtml = '<p class=\"tag-editor__empty\">No tags yet. Add your first tag above!</p>';\n    } else {\n        // Render active tags\n        state.tentativeTags.forEach(tag => {\n            tagsHtml += `<button type=\"button\" class=\"tag-editor__item\" data-tag=\"${tag}\" aria-label=\"Remove tag: ${tag}\">${tag} <span class=\"tag-editor__remove\">\u00D7</span></button>`;\n        });\n        // Render tentatively removed tags\n        state.tentativeTagsRemoved.forEach(tag => {\n            tagsHtml += `<button type=\"button\" class=\"tag-editor__item tag-editor__item--removed\" data-tag=\"${tag}\" aria-label=\"Restore tag: ${tag}\">${tag} <span class=\"tag-editor__restore\">+</span></button>`;\n        });\n    }\n\n    const html = `\n        <div class=\"tag-editor\">\n            <div class=\"tag-editor__add\">\n                <input type=\"text\" class=\"tag-editor__input\" placeholder=\"Add new tag...\" aria-label=\"New tag name\">\n                <button type=\"button\" class=\"tag-editor__add-btn\">Add</button>\n            </div>\n            <div class=\"tag-editor__list\" role=\"list\" aria-label=\"Tags for this paper\">\n                ${tagsHtml}\n            </div>\n            <div class=\"tag-editor__buttons\">\n                <button type=\"button\" class=\"tag-editor__cancel\">Cancel</button>\n                <button type=\"button\" class=\"tag-editor__save\">Save Tag Changes</button>\n            </div>\n        </div>\n    `;\n\n    tagsContainer.innerHTML = html;\n\n    // Focus the input\n    const input = tagsContainer.querySelector('.tag-editor__input');\n    if (input) {\n        input.focus();\n    }\n\n    // Add event listeners for the inline editor\n    setupInlineEditorListeners(tagsContainer);\n}\n\n/**\n * Setup event listeners for inline editor\n */\nfunction setupInlineEditorListeners(tagsContainer) {\n    console.log('setupInlineEditorListeners called');\n\n    const input = tagsContainer.querySelector('.tag-editor__input');\n    const addBtn = tagsContainer.querySelector('.tag-editor__add-btn');\n    const cancelBtn = tagsContainer.querySelector('.tag-editor__cancel');\n    const saveBtn = tagsContainer.querySelector('.tag-editor__save');\n\n    console.log('Elements found:', { input, addBtn, cancelBtn, saveBtn });\n\n    // Add tag button\n    if (addBtn) {\n        addBtn.addEventListener('click', (e) => {\n            e.stopPropagation();\n            addInlineTag(tagsContainer);\n        });\n    } else {\n        console.error('tag-editor__add-btn not found!');\n    }\n\n    // Enter key in input\n    if (input) {\n        input.addEventListener('keydown', (e) => {\n            if (e.key === 'Enter') {\n                e.preventDefault();\n                addInlineTag(tagsContainer);\n            }\n        });\n    }\n\n    // Cancel button\n    if (cancelBtn) {\n        cancelBtn.addEventListener('click', () => {\n            // Check for unsaved changes before canceling\n            if (hasUnsavedChanges()) {\n                if (confirm('You have unsaved changes. Discard them?')) {\n                    closeTagDialog();\n                    import('../papers.js').then(({ applyTagFilter }) => {\n                        applyTagFilter();\n                    });\n                }\n            } else {\n                closeTagDialog();\n                import('../papers.js').then(({ applyTagFilter }) => {\n                    applyTagFilter();\n                });\n            }\n        });\n    }\n\n    // Save button\n    if (saveBtn) {\n        saveBtn.addEventListener('click', saveTagChanges);\n    }\n\n    // Tag item clicks (to toggle removal)\n    tagsContainer.querySelectorAll('.tag-editor__item').forEach(tagItem => {\n        tagItem.addEventListener('click', (e) => {\n            e.stopPropagation(); // Prevent bubbling to document click handler\n            const tag = tagItem.dataset.tag;\n            const isRemoved = tagItem.classList.contains('tag-editor__item--removed');\n\n            if (isRemoved) {\n                // Restore: move from removed back to active\n                const index = state.tentativeTagsRemoved.indexOf(tag);\n                if (index > -1) {\n                    state.tentativeTagsRemoved.splice(index, 1);\n                    state.tentativeTags.push(tag);\n                }\n            } else {\n                // Remove: move from active to removed\n                const index = state.tentativeTags.indexOf(tag);\n                if (index > -1) {\n                    state.tentativeTags.splice(index, 1);\n                    state.tentativeTagsRemoved.push(tag);\n                }\n            }\n            renderInlineTagEditor(tagsContainer);\n        });\n    });\n}\n\n/**\n * Add a tag in inline editor\n */\nfunction addInlineTag(tagsContainer) {\n    const input = tagsContainer.querySelector('.tag-editor__input');\n    if (!input) return;\n\n    const tagName = input.value.trim();\n    if (!tagName) return;\n\n    // Check if tag already exists\n    if (state.tentativeTags.includes(tagName) || state.tentativeTagsRemoved.includes(tagName)) {\n        showError('Tag already exists');\n        return;\n    }\n\n    // Add to tentativeTags\n    state.tentativeTags.push(tagName);\n\n    // Clear input and re-render\n    input.value = '';\n    renderInlineTagEditor(tagsContainer);\n\n    // Focus the input again\n    const newInput = tagsContainer.querySelector('.tag-editor__input');\n    if (newInput) newInput.focus();\n}\n\n/**\n * Close tag dialog (inline version)\n */\nexport function closeTagDialog({ restoreContent = true } = {}) {\n    if (state.currentEditingKey === null) return;\n\n    let card = document.querySelector(`.paper[data-key=\"${state.currentEditingKey}\"]`);\n    if (!card) {\n        card = document.querySelector(`.paper-card[data-key=\"${state.currentEditingKey}\"]`);\n    }\n    if (card) {\n        const tagsContainer = card.querySelector('.tags-container');\n        if (tagsContainer) {\n            // Always remove editing class\n            tagsContainer.classList.remove('editing');\n\n            if (restoreContent && tagsContainer.dataset.originalContent) {\n                // Restore original content\n                tagsContainer.innerHTML = tagsContainer.dataset.originalContent;\n                delete tagsContainer.dataset.originalContent;\n            } else if (!restoreContent) {\n                // Clear the editing UI and remove originalContent data\n                delete tagsContainer.dataset.originalContent;\n            }\n        }\n    }\n\n    store.set({\n        currentEditingKey: null,\n        tentativeTags: [],\n        tentativeTagsRemoved: []\n    });\n}\n\n/**\n * Save tag changes (inline version)\n */\nfunction saveTagChanges() {\n    if (!state.currentEditingKey) return;\n\n    const paper = state.papersData[state.currentEditingKey];\n\n    // Final tags are just the active tags (tentativeTags)\n    // Tags in tentativeTagsRemoved are not saved\n    const finalTags = [...state.tentativeTags];\n\n    // Calculate changes\n    const originalTags = paper._tags || [];\n    const tagsRemoved = originalTags.filter(t => !finalTags.includes(t));\n    const tagsAdded = finalTags.filter(t => !originalTags.includes(t));\n\n    // Build confirmation message\n    let confirmMessage = `Save tag changes for \"${paper.title || state.currentEditingKey}\"?\\n\\n`;\n    if (tagsAdded.length > 0) {\n        confirmMessage += `Adding: ${tagsAdded.join(', ')}\\n`;\n    }\n    if (tagsRemoved.length > 0) {\n        confirmMessage += `Removing: ${tagsRemoved.join(', ')}\\n`;\n    }\n    if (tagsAdded.length === 0 && tagsRemoved.length === 0) {\n        confirmMessage += 'No changes to tags.';\n    }\n    confirmMessage += '\\n\\nThis action cannot be undone.';\n\n    // Show confirmation\n    if (confirm(confirmMessage)) {\n        // Apply changes to papersData\n        paper._tags = finalTags;\n\n        // Update the paper reference in processedPapersData to ensure filtering works correctly\n        const processedEntry = state.processedPapersData.find(entry => entry.key === state.currentEditingKey);\n        if (processedEntry) {\n            processedEntry.paper = state.papersData[state.currentEditingKey];\n        }\n\n        // Re-render paper cards\n        import('../papers.js').then(({ applyTagFilter }) => {\n            applyTagFilter();\n        });\n\n        showStatus('Tags updated successfully');\n    }\n\n    closeTagDialog({ restoreContent: false });\n}\n", "// Comments module - comment auto-save\n\nimport { state } from '../state.js';\n\n/**\n * Save comment to papersData\n */\nexport function saveComment(key, comment) {\n    if (!state.papersData[key]) return;\n\n    const paper = state.papersData[key];\n    const oldComment = paper._comments || '';\n\n    // Only save if the comment actually changed\n    if (oldComment !== comment) {\n        paper._comments = comment;\n\n        // Update the paper reference in processedPapersData\n        const processedEntry = state.processedPapersData.find(entry => entry.key === key);\n        if (processedEntry) {\n            processedEntry.paper = state.papersData[key];\n        }\n\n        console.log(`Comment saved for \"${key}\"`);\n    }\n}\n", "// Onboarding module - onboarding flow\n\nimport { get } from '../dom.js';\n\nlet currentStep = 0;\nconst totalSteps = 6;\n\nlet onboardingModal;\nlet onboardingBackBtn;\nlet onboardingNextBtn;\nlet onboardingCompleteBtn;\nlet onboardingSteps;\nlet onboardingDots;\n\nexport function initOnboardingDOM() {\n    onboardingModal = get('onboardingModal');\n    onboardingBackBtn = get('onboardingBackBtn');\n    onboardingNextBtn = get('onboardingNextBtn');\n    onboardingCompleteBtn = get('onboardingCompleteBtn');\n    onboardingSteps = document.querySelectorAll('.onboarding__step');\n    onboardingDots = document.querySelectorAll('.onboarding__dot');\n}\n\n/**\n * Set a cookie\n */\nexport function setCookie(name, value, days) {\n    const expires = new Date();\n    expires.setTime(expires.getTime() + days * 24 * 60 * 60 * 1000);\n    document.cookie = `${name}=${value};expires=${expires.toUTCString()};path=/;SameSite=Lax`;\n}\n\n/**\n * Get a cookie\n */\nexport function getCookie(name) {\n    const nameEQ = `${name}=`;\n    const cookies = document.cookie.split(';');\n    for (let i = 0; i < cookies.length; i++) {\n        let cookie = cookies[i];\n        while (cookie.charAt(0) === ' ') {\n            cookie = cookie.substring(1, cookie.length);\n        }\n        if (cookie.indexOf(nameEQ) === 0) {\n            return cookie.substring(nameEQ.length, cookie.length);\n        }\n    }\n    return null;\n}\n\n/**\n * Check if user has completed onboarding\n */\nexport function hasCompletedOnboarding() {\n    return getCookie('argonaut_onboarding_complete') === 'true';\n}\n\n/**\n * Mark onboarding as complete\n */\nexport function markOnboardingComplete() {\n    setCookie('argonaut_onboarding_complete', 'true', 365);\n}\n\n/**\n * Show onboarding modal\n */\nexport function showOnboarding() {\n    currentStep = 0;\n    updateOnboardingUI();\n    if (onboardingModal) {\n        onboardingModal.classList.add('onboarding--active');\n        onboardingModal.setAttribute('aria-hidden', 'false');\n        document.body.style.overflow = 'hidden';\n    }\n}\n\n/**\n * Hide onboarding modal\n */\nexport function hideOnboarding() {\n    if (onboardingModal) {\n        onboardingModal.classList.remove('onboarding--active');\n        onboardingModal.setAttribute('aria-hidden', 'true');\n        document.body.style.overflow = '';\n    }\n}\n\n/**\n * Update onboarding UI based on current step\n */\nexport function updateOnboardingUI() {\n    if (!onboardingModal) return;\n\n    // Update steps\n    if (onboardingSteps) {\n        onboardingSteps.forEach((step, index) => {\n            step.classList.toggle('onboarding__step--active', index === currentStep);\n        });\n    }\n\n    // Update dots with proper ARIA attributes\n    if (onboardingDots) {\n        onboardingDots.forEach((dot, index) => {\n            const isActive = index === currentStep;\n            dot.classList.toggle('onboarding__dot--active', isActive);\n            dot.setAttribute('aria-selected', isActive.toString());\n            dot.setAttribute('tabindex', isActive ? '0' : '-1');\n        });\n    }\n\n    // Update buttons - use visibility for Back button to maintain layout\n    if (onboardingBackBtn) {\n        onboardingBackBtn.style.visibility = currentStep === 0 ? 'hidden' : 'visible';\n    }\n    if (onboardingNextBtn) {\n        onboardingNextBtn.style.display = currentStep === totalSteps - 1 ? 'none' : 'block';\n    }\n    if (onboardingCompleteBtn) {\n        onboardingCompleteBtn.style.display = currentStep === totalSteps - 1 ? 'block' : 'none';\n    }\n\n    // Focus the modal for accessibility\n    if (currentStep === 0) {\n        onboardingModal.focus();\n    }\n}\n\n/**\n * Go to next step\n */\nexport function nextStep() {\n    if (currentStep < totalSteps - 1) {\n        currentStep++;\n        updateOnboardingUI();\n    }\n}\n\n/**\n * Go to previous step\n */\nexport function prevStep() {\n    if (currentStep > 0) {\n        currentStep--;\n        updateOnboardingUI();\n    }\n}\n\n/**\n * Go to specific step\n */\nexport function goToStep(step) {\n    currentStep = step;\n    updateOnboardingUI();\n}\n\n/**\n * Complete onboarding\n */\nexport function completeOnboarding() {\n    markOnboardingComplete();\n    hideOnboarding();\n}\n\n/**\n * Initialize onboarding on page load\n */\nexport function initOnboarding() {\n    if (!hasCompletedOnboarding()) {\n        // Delay showing onboarding to let the page load first\n        setTimeout(() => {\n            showOnboarding();\n        }, 500);\n    }\n}\n\n/**\n * Initialize onboarding event listeners\n */\nexport function initOnboardingListeners(closeOnboardingBtn, showOnboardingBtn) {\n    if (closeOnboardingBtn) {\n        closeOnboardingBtn.addEventListener('click', () => hideOnboarding());\n    }\n\n    if (onboardingNextBtn) {\n        onboardingNextBtn.addEventListener('click', nextStep);\n    }\n\n    if (onboardingBackBtn) {\n        onboardingBackBtn.addEventListener('click', prevStep);\n    }\n\n    if (onboardingCompleteBtn) {\n        onboardingCompleteBtn.addEventListener('click', completeOnboarding);\n    }\n\n    if (showOnboardingBtn) {\n        showOnboardingBtn.addEventListener('click', showOnboarding);\n    }\n\n    // Click on dots to go to specific step\n    if (onboardingDots) {\n        onboardingDots.forEach(dot => {\n            dot.addEventListener('click', () => {\n                goToStep(parseInt(dot.dataset.step));\n            });\n        });\n    }\n\n    // Close modal on escape key\n    document.addEventListener('keydown', (e) => {\n        if (e.key === 'Escape' && onboardingModal && onboardingModal.classList.contains('onboarding--active')) {\n            hideOnboarding();\n        }\n    });\n\n    // Close modal on backdrop click\n    if (onboardingModal) {\n        onboardingModal.addEventListener('click', (e) => {\n            if (e.target === onboardingModal) {\n                hideOnboarding();\n            }\n        });\n    }\n}\n", "// UI concerns - theme, onboarding, tag editing, storage, export, file ops\n// Main entry point - re-exports all functions from submodules for backward compatibility\n\nimport { state, store } from '../state.js';\nimport { get, getMultiple, register } from '../dom.js';\n\nexport * from './theme.js';\nexport * from './notifications.js';\nexport * from './storage.js';\nexport * from './export.js';\nexport * from './load.js';\nexport * from './inputOptions.js';\nexport * from './saveOptions.js';\nexport * from './tagEditor.js';\nexport * from './comments.js';\nexport * from './onboarding.js';\n\n// Also export saveOptions under the expected name\nexport { updateSaveOptionUI, initSaveOptions } from './saveOptions.js';\n\n// Import submodules for internal use\nimport { initThemeDOM, initThemeListener, initTheme } from './theme.js';\nimport { initNotificationsDOM } from './notifications.js';\nimport { initStorageDOM, clearCurrentData, saveToStorage, loadFromStorage } from './storage.js';\nimport { initExportDOM, exportJSON, exportBibTeX, exportBibTeXTagged } from './export.js';\nimport { initLoadDOM, loadPapers } from './load.js';\nimport { initInputOptionsDOM, updateInputOptionUI, initInputOptions } from './inputOptions.js';\nimport { updateSaveOptionUI, initSaveOptions } from './saveOptions.js';\nimport { initTagEditorDOM, openTagDialog, updateExportButtonStates } from './tagEditor.js';\nimport { initOnboardingDOM, initOnboarding, hideOnboarding, nextStep, prevStep, goToStep, completeOnboarding, showOnboarding as showOnboardingFunc, initOnboardingListeners } from './onboarding.js';\nimport { hideStatus } from './notifications.js';\n\n// DOM Elements - for internal use (via registry)\nlet loadJsonSection;\nlet saveJsonSection;\nlet papersSection;\nlet exportResetSection;\nlet papersList;\nlet fileInput;\nlet urlInput;\nlet loadUrlBtn;\nlet loadFromStorageBtn;\nlet loadNewBtn;\nlet saveToStorageBtn;\nlet exportJsonBtn;\nlet exportBibtexAllBtn;\nlet exportBibtexTaggedBtn;\n\n// Save JSON Collection Elements\nlet jsonFormatSelector;\n\n// Onboarding elements\nlet closeOnboardingBtn;\nlet showOnboardingBtn;\n\n// Initialize all DOM elements - must be called after DOM is ready\nexport function initDOM() {\n    // Initialize submodule DOM elements\n    initNotificationsDOM();\n    initThemeDOM();\n    initStorageDOM();\n    initExportDOM();\n    initLoadDOM();\n    initInputOptionsDOM();\n    initTagEditorDOM();\n    initOnboardingDOM();\n\n    // Get DOM elements from registry\n    const elements = getMultiple(\n        'loadJsonSection',\n        'saveJsonSection',\n        'papersSection',\n        'exportResetSection',\n        'papersList',\n        'fileInput',\n        'urlInput',\n        'loadUrlBtn',\n        'loadFromStorageBtn',\n        'loadNewBtn',\n        'saveToStorageBtn',\n        'exportJsonBtn',\n        'exportBibtexAllBtn',\n        'exportBibtexTaggedBtn',\n        'jsonFormatSelector',\n        'closeOnboardingBtn',\n        'showOnboardingBtn'\n    );\n\n    // Assign to local variables\n    loadJsonSection = elements.loadJsonSection;\n    saveJsonSection = elements.saveJsonSection;\n    papersSection = elements.papersSection;\n    exportResetSection = elements.exportResetSection;\n    papersList = elements.papersList;\n    fileInput = elements.fileInput;\n    urlInput = elements.urlInput;\n    loadUrlBtn = elements.loadUrlBtn;\n    loadFromStorageBtn = elements.loadFromStorageBtn;\n    loadNewBtn = elements.loadNewBtn;\n    saveToStorageBtn = elements.saveToStorageBtn;\n    exportJsonBtn = elements.exportJsonBtn;\n    exportBibtexAllBtn = elements.exportBibtexAllBtn;\n    exportBibtexTaggedBtn = elements.exportBibtexTaggedBtn;\n    jsonFormatSelector = elements.jsonFormatSelector;\n    closeOnboardingBtn = elements.closeOnboardingBtn;\n    showOnboardingBtn = elements.showOnboardingBtn;\n\n    // Set initial state for export buttons\n    updateExportButtonStates();\n\n    console.log('[UI] DOM elements initialized');\n}\n\n// Initialize all event listeners - must be called after DOM is ready\nexport function initEventListeners() {\n    console.log('[UI] Initializing event listeners');\n\n    // Initialize theme listener\n    initThemeListener();\n\n    // Input option switching\n    document.querySelectorAll('input[name=\"inputMethod\"]').forEach(radio => {\n        radio.addEventListener('change', (e) => {\n            updateInputOptionUI(e.target.value);\n        });\n    });\n\n    // Save option switching\n    document.querySelectorAll('input[name=\"saveMethod\"]').forEach(radio => {\n        radio.addEventListener('change', () => updateSaveOptionUI(radio.value));\n    });\n\n    // File input handler\n    if (fileInput) {\n        fileInput.addEventListener('change', () => {\n            if (fileInput.files[0]) {\n                loadPapers('file');\n            }\n        });\n    }\n\n    // URL load button handler\n    if (loadUrlBtn) {\n        loadUrlBtn.addEventListener('click', () => loadPapers('url'));\n    }\n\n    // Load from browser storage button handler\n    if (loadFromStorageBtn) {\n        loadFromStorageBtn.addEventListener('click', loadFromStorage);\n    }\n\n    // Reset All button\n    if (loadNewBtn) {\n        loadNewBtn.addEventListener('click', () => {\n            const confirmed = confirm(\n                'Are you sure you want to reset all papers?\\n\\n' +\n                'This will clear:\\n' +\n                '\u2022 All papers\\n' +\n                '\u2022 All comments\\n' +\n                '\u2022 All tags\\n' +\n                '\u2022 Any unsaved changes\\n\\n' +\n                'This action cannot be undone.'\n            );\n            if (confirmed) {\n                store.setSelectedTags([]);\n                store.set({\n                    papersData: {},\n                    processedPapersData: []\n                });\n                if (papersSection) papersSection.style.display = 'none';\n                if (saveJsonSection) saveJsonSection.style.display = 'none';\n                if (exportResetSection) exportResetSection.style.display = 'none';\n                if (loadJsonSection) loadJsonSection.style.display = 'block';\n                if (papersList) papersList.innerHTML = '';\n                if (fileInput) fileInput.value = '';\n                if (urlInput) urlInput.value = 'https://gist.githubusercontent.com/srtee/04ee671f6f27d64de800f00eb9280a21/raw/papers.json';\n                hideStatus();\n            }\n        });\n    }\n\n    // Save to browser storage button\n    if (saveToStorageBtn) {\n        saveToStorageBtn.addEventListener('click', saveToStorage);\n    }\n\n    // Export JSON button\n    if (exportJsonBtn) {\n        console.log('[UI] Export JSON button found, adding click handler');\n        exportJsonBtn.addEventListener('click', () => {\n            console.log('[UI] Export JSON button clicked');\n            exportJSON();\n        });\n    }\n\n    // Export BibTeX (all) button\n    if (exportBibtexAllBtn) {\n        exportBibtexAllBtn.addEventListener('click', exportBibTeX);\n    }\n\n    // Export BibTeX (only tagged) button\n    if (exportBibtexTaggedBtn) {\n        exportBibtexTaggedBtn.addEventListener('click', exportBibTeXTagged);\n    }\n\n    // Initialize onboarding listeners\n    initOnboardingListeners(closeOnboardingBtn, showOnboardingBtn);\n\n    // Papers list event listeners for inline tag editing\n    if (papersList) {\n        papersList.addEventListener('click', (e) => {\n            const editBtn = e.target.closest('.tag-edit-btn');\n            if (editBtn) {\n                e.stopPropagation();\n                const key = editBtn.dataset.key;\n                console.log('Edit button clicked, key:', key);\n                openTagDialog(key);\n            }\n        });\n    }\n\n    // Escape key to close inline editor\n    document.addEventListener('keydown', async (e) => {\n        if (e.key === 'Escape' && state.currentEditingKey !== null) {\n            const { hasUnsavedChanges, closeTagDialog } = await import('./tagEditor.js');\n            if (hasUnsavedChanges()) {\n                if (confirm('You have unsaved changes. Discard them?')) {\n                    closeTagDialog();\n                    import('../papers.js').then(({ applyTagFilter }) => {\n                        applyTagFilter();\n                    });\n                }\n            } else {\n                closeTagDialog();\n                import('../papers.js').then(({ applyTagFilter }) => {\n                    applyTagFilter();\n                });\n            }\n        }\n    });\n\n    // Click outside to close inline editor\n    document.addEventListener('click', (e) => {\n        if (state.currentEditingKey !== null) {\n            const editor = document.querySelector('.tag-editor');\n            if (editor && !editor.contains(e.target)) {\n                import('./tagEditor.js').then(({ hasUnsavedChanges, closeTagDialog }) => {\n                    if (hasUnsavedChanges()) {\n                        if (confirm('You have unsaved changes. Discard them?')) {\n                            closeTagDialog();\n                            import('../papers.js').then(({ applyTagFilter }) => {\n                                applyTagFilter();\n                            });\n                        }\n                    } else {\n                        closeTagDialog();\n                        import('../papers.js').then(({ applyTagFilter }) => {\n                            applyTagFilter();\n                        });\n                    }\n                });\n            }\n        }\n    });\n\n    // Auto-save comment on blur (when clicking away)\n    if (papersList) {\n        papersList.addEventListener('blur', (e) => {\n            if (e.target.classList.contains('comments')) {\n                const key = e.target.dataset.key;\n                const newComment = e.target.value;\n                import('./comments.js').then(({ saveComment }) => {\n                    saveComment(key, newComment);\n                });\n            }\n        }, true);\n    }\n\n    console.log('[UI] Event listeners initialized');\n}\n", "// GitHub Gist CRUD operations\n\nimport { getSessionId } from './auth.js';\nimport { WORKER_BASE_URL } from './state.js';\nimport { get, getMultiple } from './dom.js';\n\n// DOM Elements - via registry\nlet loadGistSelector;\nlet saveGistSelector;\nlet loadFromGistCollectionBtn;\nlet saveToGistOptionBtn;\nlet gistConnectedContent;\nlet saveGistConnectedContent;\nlet jsonFormatSelector;\n\n// Initialize all DOM elements - must be called after DOM is ready\nexport function initDOM() {\n    const elements = getMultiple(\n        'loadGistSelector',\n        'saveGistSelector',\n        'loadFromGistCollectionBtn',\n        'saveToGistOptionBtn',\n        'gistConnectedContent',\n        'saveGistConnectedContent',\n        'jsonFormatSelector'\n    );\n\n    loadGistSelector = elements.loadGistSelector;\n    saveGistSelector = elements.saveGistSelector;\n    loadFromGistCollectionBtn = elements.loadFromGistCollectionBtn;\n    saveToGistOptionBtn = elements.saveToGistOptionBtn;\n    gistConnectedContent = elements.gistConnectedContent;\n    saveGistConnectedContent = elements.saveGistConnectedContent;\n    jsonFormatSelector = elements.jsonFormatSelector;\n\n    // Add event listeners after elements are assigned\n    if (loadFromGistCollectionBtn) {\n        loadFromGistCollectionBtn.addEventListener('click', loadFromGistCollection);\n    }\n    if (saveToGistOptionBtn) {\n        saveToGistOptionBtn.addEventListener('click', saveToGistCollection);\n    }\n\n    console.log('[GitHub] DOM elements initialized');\n}\n\n/**\n * List user's gists\n */\nexport async function listGists() {\n    console.log('[GitHub API] Listing user gists');\n    const sessionId = getSessionId();\n    const headers = {};\n    if (sessionId) {\n        headers['Authorization'] = `Bearer ${sessionId}`;\n    }\n\n    const res = await fetch(`${WORKER_BASE_URL}/api/github/gists`, {\n        headers,\n        credentials: 'include'\n    });\n    if (!res.ok) {\n        const error = await res.json();\n        console.error('[GitHub API] Failed to list gists:', error);\n        throw new Error(error.error || 'Failed to fetch gists');\n    }\n    const gists = await res.json();\n    console.log('[GitHub API] Listed gists:', gists.length);\n    return gists;\n}\n\n/**\n * Get specific gist content\n */\nexport async function getGist(gistId) {\n    console.log('[GitHub API] Getting gist:', gistId);\n    const sessionId = getSessionId();\n    const headers = {};\n    if (sessionId) {\n        headers['Authorization'] = `Bearer ${sessionId}`;\n    }\n\n    const res = await fetch(`${WORKER_BASE_URL}/api/github/gists/${gistId}`, {\n        headers,\n        credentials: 'include'\n    });\n    if (!res.ok) {\n        const error = await res.json();\n        console.error('[GitHub API] Failed to get gist:', gistId, error);\n        throw new Error(error.error || 'Failed to fetch gist');\n    }\n    const gist = await res.json();\n    console.log('[GitHub API] Got gist:', gistId);\n    return gist;\n}\n\n/**\n * Create new gist\n */\nexport async function createGist(files, description = 'Argonaut Papers') {\n    console.log('[GitHub API] Creating new gist with description:', description);\n    const sessionId = getSessionId();\n    const headers = {\n        'Content-Type': 'application/json'\n    };\n    if (sessionId) {\n        headers['Authorization'] = `Bearer ${sessionId}`;\n    }\n\n    const res = await fetch(`${WORKER_BASE_URL}/api/github/gists`, {\n        method: 'POST',\n        headers,\n        body: JSON.stringify({ description, public: false, files }),\n        credentials: 'include'\n    });\n    if (!res.ok) {\n        const error = await res.json();\n        console.error('[GitHub API] Failed to create gist:', error);\n        throw new Error(error.error || 'Failed to create gist');\n    }\n    const gist = await res.json();\n    console.log('[GitHub API] Created gist:', gist.id);\n    return gist;\n}\n\n/**\n * Update existing gist\n */\nexport async function updateGist(gistId, files, description = 'Argonaut Papers') {\n    console.log('[GitHub API] Updating gist:', gistId);\n    const sessionId = getSessionId();\n    const headers = {\n        'Content-Type': 'application/json'\n    };\n    if (sessionId) {\n        headers['Authorization'] = `Bearer ${sessionId}`;\n    }\n\n    const res = await fetch(`${WORKER_BASE_URL}/api/github/gists/${gistId}`, {\n        method: 'PATCH',\n        headers,\n        body: JSON.stringify({ description, files }),\n        credentials: 'include'\n    });\n    if (!res.ok) {\n        const error = await res.json();\n        console.error('[GitHub API] Failed to update gist:', gistId, error);\n        throw new Error(error.error || 'Failed to update gist');\n    }\n    const gist = await res.json();\n    console.log('[GitHub API] Updated gist:', gistId);\n    return gist;\n}\n\n/**\n * Load gist options for the Load JSON Collection section\n */\nexport async function loadGistOptionsForLoadSelector() {\n    console.log('[GitHub Gist] Loading gist options for load selector');\n    try {\n        const gists = await listGists();\n\n        // Clear existing options\n        if (loadGistSelector) {\n            loadGistSelector.innerHTML = '';\n\n            if (gists.length === 0) {\n                console.log('[GitHub Gist] No gists found');\n                loadGistSelector.innerHTML = '<option value=\"\">No gists found</option>';\n                return;\n            }\n\n            // Add options for each gist\n            gists.forEach(gist => {\n                const option = document.createElement('option');\n                option.value = gist.id;\n                // Use description or first filename as label\n                const label = gist.description || Object.keys(gist.files)[0] || 'Unnamed gist';\n                option.textContent = label;\n                loadGistSelector.appendChild(option);\n            });\n\n            console.log('[GitHub Gist] Loaded', gists.length, 'gist options for load selector');\n        }\n    } catch (err) {\n        console.error('[GitHub Gist] Error loading gists for load selector:', err);\n        if (loadGistSelector) {\n            loadGistSelector.innerHTML = '<option value=\"\">Failed to load gists</option>';\n        }\n    }\n}\n\n/**\n * Load gist options for the Save JSON Collection section\n */\nexport async function loadGistOptionsForSaveSelector() {\n    console.log('[GitHub Gist] Loading gist options for save selector');\n    try {\n        const gists = await listGists();\n\n        // Clear existing options\n        if (saveGistSelector) {\n            saveGistSelector.innerHTML = '';\n\n            // Add \"(new gist)\" as the first option\n            const newGistOption = document.createElement('option');\n            newGistOption.value = 'new';\n            newGistOption.textContent = '(new gist)';\n            saveGistSelector.appendChild(newGistOption);\n\n            if (gists.length === 0) {\n                console.log('[GitHub Gist] No existing gists found');\n                return;\n            }\n\n            // Add options for each gist\n            gists.forEach(gist => {\n                const option = document.createElement('option');\n                option.value = gist.id;\n                // Use description or first filename as label\n                const label = gist.description || Object.keys(gist.files)[0] || 'Unnamed gist';\n                option.textContent = label;\n                saveGistSelector.appendChild(option);\n            });\n\n            console.log('[GitHub Gist] Loaded', gists.length, 'gist options for save selector');\n        }\n    } catch (err) {\n        console.error('[GitHub Gist] Error loading gists for save selector:', err);\n        if (saveGistSelector) {\n            saveGistSelector.innerHTML = '<option value=\"\">Failed to load gists</option>';\n        }\n    }\n}\n\n/**\n * Load papers from selected gist in Load JSON Collection section\n */\nexport async function loadFromGistCollection() {\n    console.log('[GitHub Gist] Loading from gist collection');\n    const gistId = loadGistSelector.value;\n\n    if (!gistId || gistId === 'Loading gists...' || gistId === 'No gists found' || gistId === 'Failed to load gists') {\n        console.log('[GitHub Gist] Invalid gist selected');\n        const { showError } = await import('./ui/index.js');\n        showError('Please select a gist to load from');\n        return;\n    }\n\n    console.log('[GitHub Gist] Loading from gist:', gistId);\n    loadFromGistCollectionBtn.classList.add('loading');\n    const { showStatus, hideStatus } = await import('./ui/index.js');\n    showStatus('Loading from Gist...');\n\n    try {\n        const gist = await getGist(gistId);\n\n        // Find papers.json file in gist\n        const papersFile = Object.values(gist.files).find(f => f.filename === 'papers.json');\n\n        if (!papersFile) {\n            console.log('[GitHub Gist] No papers.json found in gist');\n            const { showError } = await import('./ui/index.js');\n            showError('Selected gist does not contain a papers.json file');\n            const { hideStatus } = await import('./ui/index.js');\n            hideStatus();\n            loadFromGistCollectionBtn.classList.remove('loading');\n            return;\n        }\n\n        // Parse JSON\n        const data = JSON.parse(papersFile.content);\n        console.log('[GitHub Gist] Loaded', Object.keys(data).length, 'papers from gist');\n\n        // Clear current data and load new data\n        const { clearCurrentData } = await import('./ui/index.js');\n        clearCurrentData();\n        const { store } = await import('./state.js');\n        store.set({ papersData: data });\n\n        // Process and display papers\n        const { processPapers } = await import('./papers.js');\n        const processedPapers = await processPapers(data);\n        const { renderPapers } = await import('./papers.js');\n        renderPapers(processedPapers);\n\n        // Switch to papers view\n        loadJsonSection.style.display = 'none';\n        saveJsonSection.style.display = 'block';\n        exportResetSection.style.display = 'block';\n        papersSection.style.display = 'block';\n\n        showStatus(`Loaded ${Object.keys(data).length} papers from Gist`);\n        setTimeout(hideStatus, 3000);\n        console.log('[GitHub Gist] Successfully loaded papers from gist:', gistId);\n    } catch (err) {\n        console.error('[GitHub Gist] Error loading from gist:', err);\n        const { showError } = await import('./ui/index.js');\n        showError('Error loading from Gist: ' + err.message);\n        const { hideStatus } = await import('./ui/index.js');\n        hideStatus();\n    } finally {\n        loadFromGistCollectionBtn.classList.remove('loading');\n    }\n}\n\n/**\n * Save papers to gist from Save JSON Collection section\n */\nexport async function saveToGistCollection() {\n    console.log('[GitHub Gist] Saving papers to gist from Save JSON Collection');\n    const gistId = saveGistSelector.value;\n\n    if (!gistId || gistId === 'Loading gists...' || gistId === 'No gists found' || gistId === 'Failed to load gists') {\n        console.log('[GitHub Gist] Invalid gist selected');\n        const { showError } = await import('./ui/index.js');\n        showError('Please select a gist to save to');\n        return;\n    }\n\n    saveToGistOptionBtn.classList.add('loading');\n    const { showStatus } = await import('./ui/index.js');\n    showStatus('Saving to Gist...');\n\n    try {\n        const { state } = await import('./state.js');\n        if (!state.papersData || Object.keys(state.papersData).length === 0) {\n            console.log('[GitHub Gist] No papers to save');\n            const { showError } = await import('./ui/index.js');\n            showError('No papers to save');\n            const { hideStatus } = await import('./ui/index.js');\n            hideStatus();\n            saveToGistOptionBtn.classList.remove('loading');\n            return;\n        }\n\n        // Get the format (full or light)\n        const format = jsonFormatSelector ? jsonFormatSelector.value : 'full';\n        let dataToSave = state.papersData;\n\n        if (format === 'light') {\n            dataToSave = {};\n            for (const [key, paper] of Object.entries(state.papersData)) {\n                dataToSave[key] = {\n                    _doi: paper._doi,\n                    _comments: paper._comments || [],\n                    _tags: paper._tags || [],\n                    _alsoread: paper._alsoread || []\n                };\n            }\n        }\n\n        const jsonStr = JSON.stringify(dataToSave, null, 2);\n        const files = { 'papers.json': { content: jsonStr } };\n        console.log('[GitHub Gist] Saving', Object.keys(dataToSave).length, 'papers');\n\n        if (gistId === 'new') {\n            console.log('[GitHub Gist] Creating new gist');\n            // Prompt user for gist name\n            const gistName = prompt('Enter a name for your new gist:', 'Argonaut Papers');\n            if (gistName === null) {\n                // User cancelled\n                const { hideStatus } = await import('./ui/index.js');\n                hideStatus();\n                saveToGistOptionBtn.classList.remove('loading');\n                return;\n            }\n            const description = gistName.trim() || 'Argonaut Papers';\n            const gist = await createGist(files, description);\n            console.log('[GitHub Gist] Created gist:', gist.id);\n            const { showStatus } = await import('./ui/index.js');\n            showStatus('Created new Gist successfully');\n\n            // Reload gist options for save selector\n            await loadGistOptionsForSaveSelector();\n        } else {\n            console.log('[GitHub Gist] Updating existing gist:', gistId);\n            await updateGist(gistId, files);\n            console.log('[GitHub Gist] Updated gist:', gistId);\n            const { showStatus } = await import('./ui/index.js');\n            showStatus('Saved to Gist successfully');\n        }\n\n        setTimeout(async () => {\n            const { hideStatus } = await import('./ui/index.js');\n            hideStatus();\n        }, 3000);\n    } catch (err) {\n        console.error('[GitHub Gist] Error saving to gist:', err);\n        const { showError } = await import('./ui/index.js');\n        showError('Error saving to Gist: ' + err.message);\n        const { hideStatus } = await import('./ui/index.js');\n        hideStatus();\n    } finally {\n        saveToGistOptionBtn.classList.remove('loading');\n    }\n}\n\n// Event listeners - added inside initDOM() after elements are assigned", "// GitHub OAuth session management\n\nimport { state, store } from './state.js';\nimport { WORKER_BASE_URL } from './state.js';\nimport { get, getMultiple } from './dom.js';\n\n// DOM Elements - via registry\nlet githubSection;\nlet githubNotLoggedIn;\nlet githubLoggedIn;\nlet githubConnectBtn;\nlet githubLogoutBtn;\nlet githubUserAvatar;\nlet githubUserName;\n\n// For visibility toggles in Load and Save sections\nlet gistConnectedContent;\nlet saveGistConnectedContent;\nlet loadJsonSection;\nlet saveJsonSection;\nlet exportResetSection;\nlet papersSection;\n\n// Initialize all DOM elements - must be called after DOM is ready\nexport function initDOM() {\n    const elements = getMultiple(\n        'githubSection',\n        'githubNotLoggedIn',\n        'githubLoggedIn',\n        'githubConnectBtn',\n        'githubLogoutBtn',\n        'githubUserAvatar',\n        'githubUserName',\n        'gistConnectedContent',\n        'saveGistConnectedContent',\n        'loadJsonSection',\n        'saveJsonSection',\n        'exportResetSection',\n        'papersSection'\n    );\n\n    githubSection = elements.githubSection;\n    githubNotLoggedIn = elements.githubNotLoggedIn;\n    githubLoggedIn = elements.githubLoggedIn;\n    githubConnectBtn = elements.githubConnectBtn;\n    githubLogoutBtn = elements.githubLogoutBtn;\n    githubUserAvatar = elements.githubUserAvatar;\n    githubUserName = elements.githubUserName;\n    gistConnectedContent = elements.gistConnectedContent;\n    saveGistConnectedContent = elements.saveGistConnectedContent;\n    loadJsonSection = elements.loadJsonSection;\n    saveJsonSection = elements.saveJsonSection;\n    exportResetSection = elements.exportResetSection;\n    papersSection = elements.papersSection;\n\n    console.log('[Auth] DOM elements initialized');\n}\n\n/**\n * Get the session ID from localStorage\n */\nexport function getSessionId() {\n    return localStorage.getItem('github_session_id');\n}\n\n/**\n * Set the session ID in localStorage\n */\nexport function setSessionId(sessionId) {\n    localStorage.setItem('github_session_id', sessionId);\n}\n\n/**\n * Clear the session ID from localStorage\n */\nexport function clearSessionId() {\n    localStorage.removeItem('github_session_id');\n}\n\n/**\n * Check if user is authenticated\n */\nexport async function checkSession() {\n    console.log('[GitHub Auth] Checking session at:', `${WORKER_BASE_URL}/session`);\n    const sessionId = getSessionId();\n    console.log('[GitHub Auth] Session ID from storage:', sessionId ? sessionId.substring(0, 10) + '...' : 'null');\n\n    try {\n        const headers = {};\n        if (sessionId) {\n            headers['Authorization'] = `Bearer ${sessionId}`;\n        }\n\n        const res = await fetch(`${WORKER_BASE_URL}/session`, {\n            headers,\n            credentials: 'include'\n        });\n        console.log('[GitHub Auth] Request URL:', res.url);\n        console.log('[GitHub Auth] Session response status:', res.status);\n        if (!res.ok) {\n            console.log('[GitHub Auth] Session response not OK');\n            return { authenticated: false };\n        }\n        const data = await res.json();\n        console.log('[GitHub Auth] Session data:', data);\n        return data;\n    } catch (err) {\n        console.error('[GitHub Auth] Error checking session:', err);\n        return { authenticated: false };\n    }\n}\n\n/**\n * Initiate GitHub OAuth login flow\n */\nexport async function initiateLogin() {\n    console.log('[GitHub Auth] Initiating login, redirecting to GitHub OAuth');\n\n    // Save current state before redirect so papers persist after OAuth callback\n    const stateToSave = {\n        hasPapers: Object.keys(state.papersData).length > 0,\n        saveJsonVisible: saveJsonSection?.style.display === 'block',\n        exportResetVisible: exportResetSection?.style.display === 'block',\n        papersVisible: papersSection?.style.display === 'block',\n        // Save actual papers data to restore after OAuth\n        papersData: state.papersData,\n        processedPapersData: state.processedPapersData,\n        selectedTags: Array.from(state.selectedTags)\n    };\n    sessionStorage.setItem('argonaut_oauth_state', JSON.stringify(stateToSave));\n\n    window.location.href = `${WORKER_BASE_URL}/login`;\n}\n\n/**\n * Logout from GitHub\n */\nexport async function logout() {\n    console.log('[GitHub Auth] Initiating logout');\n    const sessionId = getSessionId();\n\n    try {\n        const headers = {};\n        if (sessionId) {\n            headers['Authorization'] = `Bearer ${sessionId}`;\n        }\n\n        const res = await fetch(`${WORKER_BASE_URL}/logout`, {\n            method: 'POST',\n            headers,\n            credentials: 'include'\n        });\n        console.log('[GitHub Auth] Logout response status:', res.status);\n        clearSessionId();\n        localStorage.removeItem('github_selected_gist');\n        console.log('[GitHub Auth] User logged out successfully');\n    } catch (err) {\n        console.error('[GitHub Auth] Error logging out:', err);\n        // Even if logout fails, clear local session\n        clearSessionId();\n        localStorage.removeItem('github_selected_gist');\n    }\n    // Update UI\n    if (githubNotLoggedIn) githubNotLoggedIn.style.display = 'block';\n    if (githubLoggedIn) githubLoggedIn.style.display = 'none';\n    if (githubConnectBtn) githubConnectBtn.style.display = 'block';\n    if (githubLogoutBtn) githubLogoutBtn.style.display = 'none';\n    // Update gist loading section\n    updateGistVisibility();\n    // Update save gist section\n    updateSaveGistVisibility();\n    console.log('[GitHub Auth] UI updated to logged-out state');\n}\n\n/**\n * Update GitHub UI with user info\n */\nexport function updateGitHubUI(user) {\n    console.log('[GitHub Auth] updateGitHubUI called with user:', user);\n    githubNotLoggedIn.style.display = 'none';\n    githubLoggedIn.style.display = 'flex';\n    githubConnectBtn.style.display = 'none';\n    githubLogoutBtn.style.display = 'inline-block';\n    githubUserAvatar.src = user.avatar_url;\n    githubUserAvatar.alt = user.login;\n    githubUserName.textContent = user.login;\n    // Update gist loading section\n    updateGistVisibility();\n    // Update save gist section\n    updateSaveGistVisibility();\n    console.log('[GitHub Auth] UI updated');\n}\n\n/**\n * Update save gist visibility based on GitHub auth state\n */\nexport function updateSaveGistVisibility() {\n    const sessionId = getSessionId();\n\n    if (sessionId) {\n        // User is authenticated\n        if (saveGistConnectedContent) saveGistConnectedContent.style.display = 'flex';\n    } else {\n        // User is not authenticated\n        if (saveGistConnectedContent) saveGistConnectedContent.style.display = 'none';\n    }\n}\n\n/**\n * Update gist visibility based on GitHub auth state\n */\nexport function updateGistVisibility() {\n    const sessionId = getSessionId();\n\n    if (sessionId) {\n        // User is authenticated\n        if (gistConnectedContent) gistConnectedContent.style.display = 'flex';\n    } else {\n        // User is not authenticated\n        if (gistConnectedContent) gistConnectedContent.style.display = 'none';\n    }\n}\n\n/**\n * Load GitHub auth status on page load\n */\nexport async function loadGitHubAuth() {\n    console.log('[GitHub Auth] loadGitHubAuth called');\n    const session = await checkSession();\n    console.log('[GitHub Auth] Session result:', session);\n    if (session.authenticated && session.user) {\n        console.log('[GitHub Auth] User authenticated, updating UI');\n        updateGitHubUI(session.user);\n        const { loadGistOptionsForLoadSelector } = await import('./github.js');\n        await loadGistOptionsForLoadSelector();\n    } else {\n        console.log('[GitHub Auth] User not authenticated or no user data');\n    }\n}\n\n/**\n * Initialize GitHub auth on page load\n */\nexport async function initGitHubAuth() {\n    console.log('[GitHub Auth] initGitHubAuth called');\n    const urlParams = new URLSearchParams(window.location.search);\n    console.log('[GitHub Auth] URL params:', Object.fromEntries(urlParams.entries()));\n\n    // Check for OAuth callback with session_id\n    const sessionId = urlParams.get('session_id');\n    const authStatus = urlParams.get('auth');\n    console.log('[GitHub Auth] Session ID from URL:', sessionId ? sessionId.substring(0, 10) + '...' : 'null');\n    console.log('[GitHub Auth] Auth status from URL:', authStatus);\n\n    if (sessionId && authStatus === 'success') {\n        console.log('[GitHub Auth] OAuth callback received, storing session ID');\n        setSessionId(sessionId);\n        console.log('[GitHub Auth] Session ID stored:', getSessionId() ? getSessionId().substring(0, 10) + '...' : 'null');\n        // Clean up URL parameters after callback\n        window.history.replaceState({}, document.title, window.location.pathname);\n        const { showStatus } = await import('./ui/index.js');\n        showStatus('Successfully connected to GitHub');\n        const { hideStatus } = await import('./ui/index.js');\n        setTimeout(hideStatus, 3000);\n\n        // Restore papers state if it was saved before redirect\n        await restorePapersState();\n    } else {\n        // Check if papers exist in main app state and display them\n        // This handles the case where page was refreshed or OAuth state was lost\n        if (state.papersData && Object.keys(state.papersData).length > 0) {\n            const { displayPapers } = await import('./papers.js');\n            await displayPapers();\n        }\n    }\n\n    await loadGitHubAuth();\n}\n\n/**\n * Restore papers state after OAuth callback\n */\nexport async function restorePapersState() {\n    // First check OAuth-specific state\n    const savedState = sessionStorage.getItem('argonaut_oauth_state');\n\n    if (savedState) {\n        try {\n            const saved = JSON.parse(savedState);\n\n            if (saved.hasPapers) {\n                // Restore the papers data and state\n                if (saved.papersData) {\n                    store.set({ papersData: saved.papersData });\n                }\n                if (saved.processedPapersData) {\n                    store.set({ processedPapersData: saved.processedPapersData });\n                }\n                if (saved.selectedTags) {\n                    store.setSelectedTags(saved.selectedTags);\n                }\n\n                // If papers were loaded, ensure the sections remain visible\n                if (saved.saveJsonVisible) saveJsonSection.style.display = 'block';\n                if (saved.exportResetVisible) exportResetSection.style.display = 'block';\n                if (saved.papersVisible) papersSection.style.display = 'block';\n                // Keep load section hidden since papers are loaded\n                loadJsonSection.style.display = 'none';\n\n                // Re-render the papers\n                const { displayPapers } = await import('./papers.js');\n                await displayPapers();\n            }\n\n            // Clear the saved state\n            sessionStorage.removeItem('argonaut_oauth_state');\n        } catch (err) {\n            console.error('[GitHub Auth] Error restoring state:', err);\n        }\n    } else if (state.papersData && Object.keys(state.papersData).length > 0) {\n        // Fallback: restore from main app state if OAuth state is missing\n        const { displayPapers } = await import('./papers.js');\n        await displayPapers();\n    }\n}\n\n// Initialize event listeners - must be called after initDOM()\nexport function initEventListeners() {\n    console.log('[Auth] Initializing event listeners');\n\n    if (githubConnectBtn) {\n        githubConnectBtn.addEventListener('click', initiateLogin);\n    }\n    if (githubLogoutBtn) {\n        githubLogoutBtn.addEventListener('click', logout);\n    }\n\n    console.log('[Auth] Event listeners initialized');\n}", "// Application entry point\n\nimport './state.js';\nimport * as auth from './auth.js';\nimport * as github from './github.js';\nimport * as papers from './papers.js';\nimport * as ui from './ui/index.js';\nimport { initAll as initDOMRegistry } from './dom.js';\n\n// Initialize on page load\ndocument.addEventListener('DOMContentLoaded', () => {\n    // Initialize centralized DOM registry first\n    initDOMRegistry();\n\n    // Initialize each module's local DOM variables from registry\n    ui.initDOM();\n    auth.initDOM();\n    github.initDOM();\n    papers.initDOM();\n\n    // Initialize event listeners\n    ui.initEventListeners();\n    papers.initEventListeners();\n    auth.initEventListeners();\n\n    ui.initTheme();\n    auth.initGitHubAuth();\n    ui.initInputOptions();\n    ui.initSaveOptions();\n    ui.initOnboarding();\n});"],
  "mappings": "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",
  "names": ["state_exports", "__export", "WORKER_BASE_URL", "state", "store", "STORAGE_KEY", "initialState", "listeners", "persist", "loadFromStorage", "_state", "init_state", "__esmMin", "toSave", "e", "saved", "updates", "fn", "tags", "_", "prop", "value", "register", "moduleName", "elements", "moduleElements", "get", "id", "registry", "getMultiple", "ids", "result", "initAll", "registerUI", "registerAuth", "registerPapers", "registerGitHub", "validateRegistry", "missingCount", "name", "element", "init_dom", "__esmMin", "initThemeDOM", "themeToggle", "get", "sunIcon", "moonIcon", "updateThemeIcons", "isDark", "getSystemPreference", "getStoredTheme", "stored", "THEME_KEY", "setTheme", "theme", "initTheme", "storedTheme", "initThemeListener", "newTheme", "init_theme", "__esmMin", "init_dom", "initNotificationsDOM", "error", "get", "status", "escapeHtml", "text", "div", "showError", "message", "showStatus", "hideStatus", "hideError", "init_notifications", "__esmMin", "init_dom", "papers_exports", "__export", "addPagesToBibTeX", "addPaperByDoi", "applyTagFilter", "createPaperCard", "displayPapers", "extractDOI", "fetchAbstract", "fetchAbstractFromCrossref", "fetchAbstractFromSemanticScholar", "fetchBibTeX", "fetchPagesFromCrossref", "formatAuthors", "generateDefaultKey", "hasSelectedTag", "initDOM", "initEventListeners", "parseBibTeX", "processPapers", "renderPapers", "updateTagVisuals", "elements", "getMultiple", "papersList", "loadJsonSection", "saveJsonSection", "exportResetSection", "papersSection", "doiInput", "doiKeyInput", "addDoiBtn", "status", "exportBibtexTaggedBtn", "input", "doiRegex", "match", "doi", "response", "err", "data", "abstract", "bibtex", "pages", "pagesRegex", "currentPages", "yearRegex", "yearMatch", "firstFieldRegex", "firstMatch", "result", "fieldRegex", "field", "value", "authorString", "author", "parts", "p", "bibInfo", "year", "cleanLastName", "keyBase", "key", "suffix", "existingKeys", "state", "customKey", "showError", "showStatus", "hideStatus", "store", "processedEntry", "newCard", "paperData", "card", "escapeHtmlStr", "text", "div", "tags", "tag", "alsoread", "ref", "comments", "abstractContent", "citationParts", "citationLine", "toggleBtn", "abstractContainer", "isExpanded", "link", "handleClick", "refKey", "refCard", "e", "toggleTag", "entries", "resolve", "processed", "i", "paper", "processedPapers", "a", "b", "aHasSelectedTag", "bHasSelectedTag", "updateExportButtonStates", "paperTags", "tagElement", "init_papers", "__esmMin", "init_state", "init_dom", "initStorageDOM", "papersList", "get", "jsonFormatSelector", "clearCurrentData", "store", "saveToStorage", "state", "showError", "format", "dataToSave", "key", "paper", "jsonStr", "showStatus", "err", "loadFromStorage", "data", "displayPapers", "init_storage", "__esmMin", "init_state", "init_notifications", "init_dom", "initExportDOM", "jsonFormatSelector", "get", "status", "saveFileWithPicker", "content", "defaultFilename", "mimeType", "writable", "getMimeTypeDescription", "getMimeTypeExtensions", "err", "blob", "url", "a", "exportJSON", "state", "showError", "format", "dataToSave", "filename", "key", "paper", "jsonStr", "showStatus", "exportJSONLight", "lightData", "exportBibTeX", "fetchBibTeX", "fetchPagesFromCrossref", "addPagesToBibTeX", "parseBibTeX", "entries", "bibtexContent", "i", "resolve", "bibtex", "pages", "exportBibTeXTagged", "tag", "init_export", "__esmMin", "init_state", "init_notifications", "init_dom", "initLoadDOM", "papersList", "get", "fileInput", "urlInput", "loadJsonSection", "saveJsonSection", "exportResetSection", "papersSection", "loadFromFile", "file", "resolve", "reject", "reader", "e", "data", "loadFromUrl", "url", "response", "err", "loadDefault", "loadPapers", "method", "hideError", "hideStatus", "showStatus", "processPapers", "processedPapers", "renderPapers", "showError", "init_load", "__esmMin", "init_notifications", "init_dom", "initInputOptionsDOM", "urlInput", "get", "updateInputOptionUI", "selectedValue", "option", "content", "selectedOption", "selectedContent", "getSessionId", "loadGistOptionsForLoadSelector", "updateGistVisibility", "initInputOptions", "selectedRadio", "urlRadio", "checkInputURLParameter", "inputURL", "loadPapers", "init_inputOptions", "__esmMin", "init_auth", "init_load", "init_dom", "updateSaveOptionUI", "selectedValue", "option", "content", "selectedOption", "selectedContent", "getSessionId", "loadGistOptionsForSaveSelector", "updateSaveGistVisibility", "initSaveOptions", "selectedRadio", "fileRadio", "init_saveOptions", "__esmMin", "init_auth", "tagEditor_exports", "__export", "closeTagDialog", "hasUnsavedChanges", "initTagEditorDOM", "openTagDialog", "toggleTag", "updateExportButtonStates", "exportBibtexTaggedBtn", "get", "state", "tag", "newTags", "index", "store", "applyTagFilter", "paper", "originalTags", "finalTags", "i", "key", "tagString", "card", "tagsContainer", "renderInlineTagEditor", "tagsHtml", "html", "input", "setupInlineEditorListeners", "addBtn", "cancelBtn", "saveBtn", "e", "addInlineTag", "saveTagChanges", "tagItem", "tagName", "showError", "newInput", "restoreContent", "tagsRemoved", "t", "tagsAdded", "confirmMessage", "processedEntry", "entry", "showStatus", "init_tagEditor", "__esmMin", "init_state", "init_notifications", "init_dom", "comments_exports", "__export", "saveComment", "key", "comment", "state", "paper", "processedEntry", "entry", "init_comments", "__esmMin", "init_state", "initOnboardingDOM", "onboardingModal", "get", "onboardingBackBtn", "onboardingNextBtn", "onboardingCompleteBtn", "onboardingSteps", "onboardingDots", "setCookie", "name", "value", "days", "expires", "getCookie", "nameEQ", "cookies", "i", "cookie", "hasCompletedOnboarding", "markOnboardingComplete", "showOnboarding", "currentStep", "updateOnboardingUI", "hideOnboarding", "step", "index", "dot", "isActive", "totalSteps", "nextStep", "prevStep", "goToStep", "completeOnboarding", "initOnboarding", "initOnboardingListeners", "closeOnboardingBtn", "showOnboardingBtn", "e", "init_onboarding", "__esmMin", "init_dom", "ui_exports", "__export", "clearCurrentData", "closeTagDialog", "completeOnboarding", "escapeHtml", "exportBibTeX", "exportBibTeXTagged", "exportJSON", "exportJSONLight", "getCookie", "getMimeTypeDescription", "getMimeTypeExtensions", "getStoredTheme", "getSystemPreference", "goToStep", "hasCompletedOnboarding", "hasUnsavedChanges", "hideError", "hideOnboarding", "hideStatus", "initDOM", "initEventListeners", "initExportDOM", "initInputOptions", "initInputOptionsDOM", "initLoadDOM", "initNotificationsDOM", "initOnboarding", "initOnboardingDOM", "initOnboardingListeners", "initSaveOptions", "initStorageDOM", "initTagEditorDOM", "initTheme", "initThemeDOM", "initThemeListener", "loadDefault", "loadFromFile", "loadFromStorage", "loadFromUrl", "loadPapers", "markOnboardingComplete", "nextStep", "openTagDialog", "prevStep", "saveComment", "saveFileWithPicker", "saveToStorage", "setCookie", "setTheme", "showError", "showOnboarding", "showStatus", "toggleTag", "updateExportButtonStates", "updateInputOptionUI", "updateOnboardingUI", "updateSaveOptionUI", "updateThemeIcons", "elements", "getMultiple", "loadJsonSection", "saveJsonSection", "papersSection", "exportResetSection", "papersList", "fileInput", "urlInput", "loadUrlBtn", "loadFromStorageBtn", "loadNewBtn", "saveToStorageBtn", "exportJsonBtn", "exportBibtexAllBtn", "exportBibtexTaggedBtn", "jsonFormatSelector", "closeOnboardingBtn", "showOnboardingBtn", "radio", "e", "store", "editBtn", "key", "state", "applyTagFilter", "editor", "newComment", "init_ui", "__esmMin", "init_state", "init_dom", "init_theme", "init_notifications", "init_storage", "init_export", "init_load", "init_inputOptions", "init_saveOptions", "init_tagEditor", "init_comments", "init_onboarding", "github_exports", "__export", "createGist", "getGist", "initDOM", "listGists", "loadFromGistCollection", "loadGistOptionsForLoadSelector", "loadGistOptionsForSaveSelector", "saveToGistCollection", "updateGist", "elements", "getMultiple", "loadGistSelector", "saveGistSelector", "loadFromGistCollectionBtn", "saveToGistOptionBtn", "gistConnectedContent", "saveGistConnectedContent", "jsonFormatSelector", "sessionId", "getSessionId", "headers", "res", "WORKER_BASE_URL", "error", "gists", "gistId", "gist", "files", "description", "option", "label", "err", "newGistOption", "showError", "showStatus", "hideStatus", "papersFile", "f", "data", "clearCurrentData", "store", "processPapers", "processedPapers", "renderPapers", "state", "format", "dataToSave", "key", "paper", "gistName", "init_github", "__esmMin", "init_auth", "init_state", "init_dom", "auth_exports", "__export", "checkSession", "clearSessionId", "getSessionId", "initDOM", "initEventListeners", "initGitHubAuth", "initiateLogin", "loadGitHubAuth", "logout", "restorePapersState", "setSessionId", "updateGistVisibility", "updateGitHubUI", "updateSaveGistVisibility", "elements", "getMultiple", "githubSection", "githubNotLoggedIn", "githubLoggedIn", "githubConnectBtn", "githubLogoutBtn", "githubUserAvatar", "githubUserName", "gistConnectedContent", "saveGistConnectedContent", "loadJsonSection", "saveJsonSection", "exportResetSection", "papersSection", "sessionId", "WORKER_BASE_URL", "headers", "res", "data", "err", "stateToSave", "state", "user", "session", "loadGistOptionsForLoadSelector", "urlParams", "authStatus", "showStatus", "hideStatus", "displayPapers", "savedState", "saved", "store", "init_auth", "__esmMin", "init_state", "init_dom", "init_state", "init_auth", "init_github", "init_papers", "init_ui", "init_dom", "initAll", "initDOM", "initEventListeners", "initTheme", "initGitHubAuth", "initInputOptions", "initSaveOptions", "initOnboarding"]
}
